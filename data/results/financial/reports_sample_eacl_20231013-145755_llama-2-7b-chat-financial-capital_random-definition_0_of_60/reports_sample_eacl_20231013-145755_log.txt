INFO:__main__:Processing label permutation 0 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'l ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Social and Relationship" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Concept: Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Geographic" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
INFO:llms.metrics:classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.143, 1.203, 1.346
tokens_per_sample: 1.148, 1.220, 1.383
fkgl_readability: 20.835, 21.492, 22.200

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.337, 0.424, 0.581
exact_match: 0.350, 0.391, 0.433
partial_match: 0.350, 0.391, 0.433
INFO:__main__:Processing label permutation 1 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Natural',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Intellectual',
 'Natural': 'Human',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that pertains to monetary resources, '
  ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that pertains to monetary resources, ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Relentless® is a line of carbonated energy drinks, suggesting the company has relationships and interactions with external stakeholders, including customers and suppliers." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including its efforts to protect data and systems from unauthorized access." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including customers, suppliers, and partners." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including stockholders, and is therefore classified under the Social and relationship category." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including the potential for unauthorized releases of digital content assets." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including the need to successfully develop resources to maintain the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with legislation related to the sale of energy drinks and its restrictions, which affects the company's relationships with governmental bodies and its compliance with regulations." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Partitioned Zone Chevron holds a concession to operate the Kingdom of Saudi Arabia’s 50 percent interest in the hydrocarbon resources in the onshore area of the Partitioned Zone between Saudi Arabia and Kuwait." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Financial" category." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Reign Inferno® Thermogenic Fuel Jalapeno Strawberry" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Ultra Energy® - a line of carbonated energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with its employees, specifically regarding the termination of a pension plan and the movement of participants to a new defined contribution plan." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Monster Rehab® drink line." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
• provide for a classified board of directors" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: 0.388, 0.455, 0.519
guideline_match_Human_Natural: -0.421, -0.263, -0.132
guideline_match_Intellectual_Manufactured: -0.595, -0.405, -0.190
guideline_match_Manufactured_Intellectual: -0.805, -0.683, -0.537
guideline_match_Natural_Human: -0.129, 0.032, 0.194
guideline_match_Social and relationship_Financial: -0.150, -0.050, 0.025
guideline_match: 0.127, 0.188, 0.246

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.904, 1.985, 2.074
tokens_per_sample: 1.904, 1.985, 2.074
fkgl_readability: 16.390, 16.943, 17.560

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.789, 0.874, 0.959
exact_match: 0.341, 0.381, 0.424
partial_match: 0.341, 0.381, 0.424
INFO:__main__:Processing label permutation 2 of 60:
{'Financial': 'Intellectual',
 'Human': 'Financial',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Human',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Natural: A sentence that deals with the company's relationships and "
 'inte ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Natural: A sentence that deals with the company's relationships and "
 ' ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
The text deals with the company's relationships with the investment community and its impact on the company's stock price and access to capital, which falls under the category of social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Intellectual" category." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
Raw material and fuel supply disruptions, staffing and operations impacts, and increased costs are all related to the company's relationships and interactions with external stakeholders, including suppliers, customers, and communities." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
Indirect regulation of GHG emissions could include bans or restrictions on technologies that use the company’s hydrocarbon products." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
The text deals with the impact of government actions related to greenhouse gas emissions and climate change on Chevron's operations and demand for its products, which falls under the category of social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Environmental investigation and remediation activities." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
The text deals with the company's interactions and relationships with external stakeholders, specifically related to environmental sustainability and regulatory compliance." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
The text deals with the company's compliance with laws, regulations, and requirements related to health, safety, and environmental issues, which falls under the category of social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
Problems faced by the company or its third-party providers, including technological or business-related disruptions, as well as cybersecurity threats and regulatory interference, could adversely impact the company's relationships and interactions with external stakeholders, communities, and regulatory bodies." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.296, -0.212, -0.125
guideline_match_Human_Manufactured: 0.000, 0.053, 0.184
guideline_match_Intellectual_Financial: 0.119, 0.214, 0.357
guideline_match_Manufactured_Intellectual: -0.341, -0.146, 0.049
guideline_match_Natural_Social and relationship: 0.097, 0.226, 0.387
guideline_match_Social and relationship_Natural: -0.425, -0.200, 0.050
guideline_match: -0.194, -0.128, -0.065

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.052, 1.081, 1.122
tokens_per_sample: 1.052, 1.081, 1.122
fkgl_readability: 20.105, 21.053, 22.036

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.289, 0.348, 0.415
exact_match: 0.406, 0.448, 0.491
partial_match: 0.406, 0.448, 0.491
INFO:__main__:Processing label permutation 3 of 60:
{'Financial': 'Manufactured',
 'Human': 'Financial',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Human',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that pertains to monetary resources, assets, '
 'liabiliti ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that pertains to monetary resources, assets, '
 'liabi ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Human: Our Java Monster® and Espresso Monster® product lines compete directly with Starbucks Frappuccino, Starbucks Doubleshot, Starbucks Doubleshot Energy Plus Coffee, Starbucks Tripleshot and other Starbucks coffee drinks, Costa Coffee, Rockstar Roasted, Dunkin Donuts, Gold Peak, Stok, High Brew, McCafé, hi*ball, Douwe Egberts Coffee, Emmi CAFFÈ, Bang Keto Coffee, Nescafe and International Delight." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including customers, suppliers, partners, and regulatory bodies, which affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Human: difficulty integrating under the commercial agreements" => "Human"
WARNING:llms.classifiers.models:Prediction "Human: Financial" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Human: Financial" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human - Investments" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: 0.313, 0.397, 0.475
guideline_match_Human_Natural: -0.026, 0.079, 0.211
guideline_match_Intellectual_Intellectual: 0.524, 0.762, 0.905
guideline_match_Manufactured_Financial: -0.415, -0.244, -0.073
guideline_match_Natural_Social and relationship: -0.097, 0.000, 0.097
guideline_match_Social and relationship_Manufactured: -0.950, -0.875, -0.750
guideline_match: 0.169, 0.236, 0.302

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.015, 1.030, 1.056
tokens_per_sample: 1.015, 1.030, 1.056
fkgl_readability: 16.177, 17.037, 17.981

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.274, 0.333, 0.400
exact_match: 0.374, 0.415, 0.457
partial_match: 0.376, 0.417, 0.459
INFO:__main__:Processing label permutation 4 of 60:
{'Financial': 'Manufactured',
 'Human': 'Social and relationship',
 'Intellectual': 'Natural',
 'Manufactured': 'Financial',
 'Natural': 'Human',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sus ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that pertains to the company's legal rights, obligations, and disputes related to its operations and business activities." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.006, 0.078, 0.165
guideline_match_Human_Natural: -0.237, -0.105, -0.026
guideline_match_Intellectual_Social and relationship: 0.024, 0.119, 0.262
guideline_match_Manufactured_Financial: -0.293, -0.146, -0.024
guideline_match_Natural_Intellectual: 0.097, 0.290, 0.484
guideline_match_Social and relationship_Human: -0.300, 0.000, 0.300
guideline_match: -0.004, 0.058, 0.121

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.026, 1.078, 1.293
tokens_per_sample: 1.026, 1.078, 1.293
fkgl_readability: 28.021, 29.002, 29.994

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.322, 0.396, 0.552
exact_match: 0.354, 0.396, 0.437
partial_match: 0.354, 0.396, 0.437
INFO:__main__:Processing label permutation 5 of 60:
{'Financial': 'Human',
 'Human': 'Financial',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Intellectual',
 'Natural': 'Manufactured',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and '
 ' ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Natural" category." => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Legislation, regulation, and other government actions related to greenhouse gas (GHG) emissions and climate change could increase Chevron's operational costs and reduce demand for its hydrocarbon and other products." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Environmental investigation and remediation activities." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text refers to the company's compliance with environmental regulations and sustainability efforts in various jurisdictions, which falls under the category of Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with environmental laws, regulations, and requirements, which are related to the company's social and relationship assets, specifically its environmental responsibility and sustainability efforts." => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.339, -0.255, -0.168
guideline_match_Human_Financial: -0.079, 0.026, 0.132
guideline_match_Intellectual_Manufactured: 0.000, 0.190, 0.381
guideline_match_Manufactured_Natural: 0.220, 0.390, 0.561
guideline_match_Natural_Social and relationship: 0.097, 0.194, 0.355
guideline_match_Social and relationship_Intellectual: -0.900, -0.775, -0.600
guideline_match: -0.226, -0.163, -0.098

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.043, 1.089, 1.248
tokens_per_sample: 1.043, 1.089, 1.248
fkgl_readability: 18.875, 19.633, 20.444

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.311, 0.381, 0.519
exact_match: 0.391, 0.433, 0.476
partial_match: 0.391, 0.433, 0.476
INFO:__main__:Processing label permutation 6 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text mentions information about the company's workforce, including employees, skills, expertise, training, recruitment, and talent development." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text refers to the company's difficulty in integrating under commercial agreements, which falls under the category of Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Incentives given to the company's bottlers, distributors, and/or retailers for achieving or exceeding certain predetermined sales goals." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text refers to legislation proposed or adopted at various levels of government and foreign jurisdictions, which involves information about the company's interactions with external stakeholders, including government agencies and communities." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: problems retaining key personnel" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including the board of directors, which is a social and relationship-based asset." => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.461, -0.368, -0.264
guideline_match_Human_Social and relationship: 0.342, 0.500, 0.658
guideline_match_Intellectual_Human: 0.452, 0.619, 0.762
guideline_match_Manufactured_Manufactured: 0.659, 0.902, 1.000
guideline_match_Natural_Natural: -0.290, 0.032, 0.355
guideline_match_Social and relationship_Intellectual: -0.600, -0.425, -0.225
guideline_match: -0.191, -0.113, -0.035

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.259, 1.315, 1.381
tokens_per_sample: 1.259, 1.315, 1.381
fkgl_readability: 19.351, 20.221, 21.129

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.452, 0.522, 0.600
exact_match: 0.331, 0.372, 0.413
partial_match: 0.331, 0.372, 0.413
INFO:__main__:Processing label permutation 7 of 60:
{'Financial': 'Human',
 'Human': 'Intellectual',
 'Intellectual': 'Financial',
 'Manufactured': 'Social and relationship',
 'Natural': 'Manufactured',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that addresses environmental '
 'resourc ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that addresses environmental '
 'res ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Censorship requirements" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text deals with legislation related to the company's use of natural resources and its environmental responsibility, which falls under the social and relationship category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Natural: Information technology systems" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Legal" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Natural: refers to physical assets, infrastructure, and tangible resources such as buildings, machinery, equipment, or any other manufactured or constructed items that contribute to the company's value." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.501, -0.441, -0.380
guideline_match_Human_Financial: -0.158, -0.053, 0.026
guideline_match_Intellectual_Human: -0.167, 0.024, 0.214
guideline_match_Manufactured_Natural: 0.073, 0.195, 0.341
guideline_match_Natural_Social and relationship: -0.194, -0.032, 0.129
guideline_match_Social and relationship_Manufactured: -0.725, -0.550, -0.300
guideline_match: -0.362, -0.312, -0.260

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.208, 1.329, 1.614
tokens_per_sample: 1.215, 1.346, 1.631
fkgl_readability: 21.141, 21.901, 22.663

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.417, 0.554, 0.828
exact_match: 0.443, 0.485, 0.528
partial_match: 0.443, 0.485, 0.528
INFO:__main__:Processing label permutation 8 of 60:
{'Financial': 'Human',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Financial',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that pertains to monetary resources, assets, '
 'liabili ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that pertains to monetary resources, assets, '
 'lia ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, customers, and partners, which affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Environmental investigation and remediation activities at third-party sites." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's interactions and relationships with external stakeholders, including environmental regulations and sustainability efforts." => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: 0.449, 0.513, 0.571
guideline_match_Human_Financial: -0.132, 0.000, 0.132
guideline_match_Intellectual_Intellectual: 0.429, 0.714, 0.905
guideline_match_Manufactured_Human: -0.732, -0.561, -0.366
guideline_match_Natural_Social and relationship: 0.000, 0.129, 0.290
guideline_match_Social and relationship_Manufactured: -0.925, -0.800, -0.625
guideline_match: 0.231, 0.291, 0.348

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.022, 1.041, 1.070
tokens_per_sample: 1.022, 1.041, 1.070
fkgl_readability: 20.278, 20.899, 21.602

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.278, 0.337, 0.404
exact_match: 0.380, 0.422, 0.465
partial_match: 0.380, 0.422, 0.465
INFO:__main__:Processing label permutation 9 of 60:
{'Financial': 'Natural',
 'Human': 'Intellectual',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Social and relationship',
 'Natural': 'Human',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that refers to physical assets, infrastructure, '
  ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that refers to physical assets, infrastructure, ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the category of "Financial."" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.667, -0.617, -0.562
guideline_match_Human_Natural: -0.237, -0.105, -0.026
guideline_match_Intellectual_Human: 0.000, 0.167, 0.333
guideline_match_Manufactured_Intellectual: 0.024, 0.098, 0.220
guideline_match_Natural_Financial: -0.323, -0.097, 0.129
guideline_match_Social and relationship_Manufactured: -0.375, -0.100, 0.200
guideline_match: -0.447, -0.397, -0.343

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.019, 1.040, 1.093
tokens_per_sample: 1.019, 1.056, 1.182
fkgl_readability: 28.050, 29.019, 29.988

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.300, 0.367, 0.474
exact_match: 0.361, 0.402, 0.444
partial_match: 0.361, 0.402, 0.444
INFO:__main__:Processing label permutation 10 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Financial',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that refers to physical assets, infrastructure, and '
 ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that refers to physical assets, infrastructure, an ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Concept: Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.322, -0.270, -0.217
guideline_match_Human_Human: nan, 1.000, nan
guideline_match_Intellectual_Social and relationship: -0.381, -0.238, -0.119
guideline_match_Manufactured_Financial: -0.122, 0.024, 0.171
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Manufactured: -0.800, -0.600, -0.300
guideline_match: -0.160, -0.106, -0.050

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.002, 1.006, 1.015
tokens_per_sample: 1.002, 1.006, 1.015
fkgl_readability: 21.839, 22.604, 23.369

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.280, 0.339, 0.407
exact_match: 0.398, 0.441, 0.483
partial_match: 0.398, 0.441, 0.483
INFO:__main__:Processing label permutation 11 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Natural',
 'Natural': 'Financial',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Intellectual: A sentence that deals with the company's relationships and "
  ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Intellectual: A sentence that deals with the company's relationships and ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Social and relationship: Intellectual" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Social and relationship:
The text deals with intellectual property laws and their potential impact on the company's ability to create, distribute, and protect content, as well as anti-piracy efforts and intellectual property rights. Therefore, it falls under the category of social and relationship." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Incentives given to the Company's bottlers/distributors and/or retailers for achieving or exceeding certain predetermined sales goals." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, specifically co-packers, which impact the company's production capacity and sales." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text deals with intangible assets such as knowledge, intellectual property, and relationships with external stakeholders, including suppliers, partners, and customers, which are essential for the company's competitiveness and innovation." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Compliance with laws, regulations, and requirements." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: -0.267, -0.191, -0.110
guideline_match_Human_Human: 0.579, 0.842, 0.947
guideline_match_Intellectual_Social and relationship: 0.048, 0.238, 0.429
guideline_match_Manufactured_Financial: -0.585, -0.390, -0.171
guideline_match_Natural_Manufactured: -0.226, -0.065, 0.065
guideline_match_Social and relationship_Intellectual: -0.100, 0.025, 0.150
guideline_match: -0.138, -0.076, -0.015

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.263, 1.386, 1.703
tokens_per_sample: 1.267, 1.433, 1.844
fkgl_readability: 23.931, 24.944, 26.016

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.420, 0.581, 0.980
exact_match: 0.439, 0.481, 0.524
partial_match: 0.444, 0.487, 0.528
INFO:__main__:Processing label permutation 12 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Financial',
 'Intellectual': 'Natural',
 'Manufactured': 'Human',
 'Natural': 'Manufactured',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that relates to intangible assets, '
 'k ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that relates to intangible assets, ' ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: •difficulty integrating under the commercial agreements" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Provide for a classified board of directors." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.516, -0.461, -0.406
guideline_match_Human_Manufactured: -0.158, -0.026, 0.079
guideline_match_Intellectual_Social and relationship: -0.048, 0.190, 0.429
guideline_match_Manufactured_Natural: 0.195, 0.439, 0.634
guideline_match_Natural_Intellectual: -0.129, 0.000, 0.129
guideline_match_Social and relationship_Financial: -0.550, -0.350, -0.125
guideline_match: -0.327, -0.275, -0.221

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.209, 1.261, 1.324
tokens_per_sample: 1.209, 1.261, 1.324
fkgl_readability: 18.883, 19.424, 19.988

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.420, 0.491, 0.567
exact_match: 0.389, 0.431, 0.474
partial_match: 0.389, 0.431, 0.474
INFO:__main__:Processing label permutation 13 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Natural',
 'Natural': 'Human',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that addresses environmental resources, '
 'sustain ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that addresses environmental resources, '
 'sus ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Intellectual" category." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human - Intangible assets, including trademarks." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Cultural:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text deals with the company's workforce and human resources aspects, specifically the termination of a defined benefit pension plan and the movement of participants to a qualified replacement plan." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.101, 0.003, 0.107
guideline_match_Human_Natural: -0.211, -0.053, 0.079
guideline_match_Intellectual_Human: -0.071, 0.119, 0.310
guideline_match_Manufactured_Intellectual: -0.024, 0.098, 0.244
guideline_match_Natural_Manufactured: 0.226, 0.387, 0.548
guideline_match_Social and relationship_Social and relationship: -0.900, -0.700, -0.400
guideline_match: -0.089, -0.015, 0.061

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.022, 1.045, 1.099
tokens_per_sample: 1.024, 1.061, 1.181
fkgl_readability: 23.956, 24.744, 25.573

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.291, 0.357, 0.465
exact_match: 0.409, 0.452, 0.493
partial_match: 0.409, 0.452, 0.493
INFO:__main__:Processing label permutation 14 of 60:
{'Financial': 'Financial',
 'Human': 'Manufactured',
 'Intellectual': 'Human',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'l ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Concept: Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that pertains to the company's legal rights, obligations, and agreements, including litigation, negotiations, and contracts." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Geographic" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that pertains to the company's legal rights, obligations, and risks related to its operations, products, and services." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.855, 0.907, 0.942
guideline_match_Human_Intellectual: 0.000, 0.026, 0.132
guideline_match_Intellectual_Social and relationship: -0.119, 0.024, 0.190
guideline_match_Manufactured_Human: -0.610, -0.439, -0.268
guideline_match_Natural_Natural: 0.419, 0.742, 0.935
guideline_match_Social and relationship_Manufactured: -0.500, -0.300, -0.100
guideline_match: 0.510, 0.571, 0.627

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.144, 1.255, 1.498
tokens_per_sample: 1.152, 1.272, 1.517
fkgl_readability: 20.522, 21.166, 21.873

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.381, 0.509, 0.746
exact_match: 0.330, 0.370, 0.411
partial_match: 0.330, 0.370, 0.411
INFO:__main__:Processing label permutation 15 of 60:
{'Financial': 'Manufactured',
 'Human': 'Intellectual',
 'Intellectual': 'Natural',
 'Manufactured': 'Human',
 'Natural': 'Financial',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sus ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: 0.128, 0.209, 0.290
guideline_match_Human_Manufactured: -0.211, -0.079, 0.026
guideline_match_Intellectual_Human: 0.095, 0.286, 0.452
guideline_match_Manufactured_Financial: -0.707, -0.512, -0.268
guideline_match_Natural_Intellectual: 0.032, 0.129, 0.290
guideline_match_Social and relationship_Social and relationship: -0.900, -0.750, -0.500
guideline_match: -0.002, 0.063, 0.128

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.007, 1.019, 1.041
tokens_per_sample: 1.007, 1.019, 1.041
fkgl_readability: 23.140, 24.042, 25.004

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.263, 0.322, 0.389
exact_match: 0.394, 0.437, 0.481
partial_match: 0.394, 0.437, 0.481
INFO:__main__:Processing label permutation 16 of 60:
{'Financial': 'Natural',
 'Human': 'Manufactured',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Human',
 'Natural': 'Intellectual',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that refers to physical assets, infrastructure, and '
 'ta ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that refers to physical assets, infrastructure, and '
 ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Social and Relationship" category." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Human - The text refers to the company's data and information, which are physical assets that contribute to the company's value." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text refers to the company's workforce, skills, and expertise, which contribute to the company's success in the extractive business." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Human - This text refers to physical assets, specifically property included in "Principal repayments of finance leases"." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Social and Relationship" category." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The company recognizes reserves for projects with various development periods, sometimes exceeding five years." => "Human"
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text pertains to monetary resources, assets, liabilities, revenues, expenses, or any other financial information related to the company's operations, investments, and financial performance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text pertains to monetary resources (pension plan), liabilities (participants' accounts in the Qualified Replacement Plan), revenues (employer contributions), and expenses (administrative costs related to the Terminated Plan and the Qualified Replacement Plan)." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human - Chevron owns and operates a network of infrastructure assets, including pipelines." => "Human"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.365, -0.287, -0.206
guideline_match_Human_Manufactured: 0.184, 0.342, 0.500
guideline_match_Intellectual_Natural: -0.262, -0.095, 0.071
guideline_match_Manufactured_Human: 0.049, 0.122, 0.244
guideline_match_Natural_Financial: -0.226, 0.000, 0.226
guideline_match_Social and relationship_Intellectual: -0.525, -0.350, -0.200
guideline_match: -0.244, -0.184, -0.125

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.333, 1.426, 1.700
tokens_per_sample: 1.333, 1.426, 1.700
fkgl_readability: 20.523, 21.361, 22.242

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.422, 0.515, 0.773
exact_match: 0.361, 0.404, 0.446
partial_match: 0.363, 0.406, 0.448
INFO:__main__:Processing label permutation 17 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Natural',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Human',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that refers to physical assets, '
 'infr ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that refers to physical assets, '
 ' ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
• difficulty integrating under the commercial agreements." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text refers to legislation proposed or adopted at various levels of government, which involves interactions with external stakeholders, communities, and governmental programs." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.559, -0.501, -0.441
guideline_match_Human_Natural: 0.000, 0.026, 0.132
guideline_match_Intellectual_Intellectual: 0.286, 0.571, 0.762
guideline_match_Manufactured_Social and relationship: -0.390, -0.195, -0.024
guideline_match_Natural_Human: 0.032, 0.129, 0.290
guideline_match_Social and relationship_Financial: -0.900, -0.800, -0.650
guideline_match: -0.395, -0.343, -0.287

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.233, 1.289, 1.352
tokens_per_sample: 1.233, 1.289, 1.352
fkgl_readability: 19.040, 19.729, 20.473

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.411, 0.481, 0.556
exact_match: 0.456, 0.498, 0.539
partial_match: 0.456, 0.498, 0.539
INFO:__main__:Processing label permutation 18 of 60:
{'Financial': 'Human',
 'Human': 'Social and relationship',
 'Intellectual': 'Natural',
 'Manufactured': 'Financial',
 'Natural': 'Intellectual',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ...  "the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sus ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Prediction "Cultural:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Social and relationship:
Adverse publicity surrounding obesity and health concerns related to our products, product safety and quality, water usage, environmental impact and sustainability, human rights, our culture, workforce and labor and workplace laws." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.577, -0.513, -0.449
guideline_match_Human_Financial: -0.211, -0.079, -0.026
guideline_match_Intellectual_Natural: 0.333, 0.476, 0.619
guideline_match_Manufactured_Social and relationship: -0.293, -0.146, 0.000
guideline_match_Natural_Intellectual: 0.032, 0.097, 0.258
guideline_match_Social and relationship_Human: -0.200, 0.100, 0.400
guideline_match: -0.354, -0.296, -0.240

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.009, 1.089, 1.468
tokens_per_sample: 1.009, 1.089, 1.468
fkgl_readability: 23.682, 24.577, 25.540

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.324, 0.422, 0.752
exact_match: 0.428, 0.470, 0.513
partial_match: 0.430, 0.472, 0.515
INFO:__main__:Processing label permutation 19 of 60:
{'Financial': 'Manufactured',
 'Human': 'Financial',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Human',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Manufactured: A sentence that involves information about the company's "
 'w ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Manufactured: A sentence that involves information about the company's " ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Human" category." => "Human"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Human" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.145, -0.058, 0.032
guideline_match_Human_Manufactured: 0.132, 0.237, 0.395
guideline_match_Intellectual_Intellectual: 0.667, 0.905, 1.000
guideline_match_Manufactured_Financial: -0.293, -0.122, 0.049
guideline_match_Natural_Social and relationship: -0.323, -0.097, 0.129
guideline_match_Social and relationship_Natural: -0.800, -0.675, -0.525
guideline_match: -0.085, -0.015, 0.052

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.043, 1.069, 1.104
tokens_per_sample: 1.043, 1.069, 1.104
fkgl_readability: 20.854, 21.851, 22.874

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.267, 0.324, 0.391
exact_match: 0.419, 0.459, 0.502
partial_match: 0.419, 0.459, 0.502
INFO:__main__:Processing label permutation 20 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Manufactured',
 'Intellectual': 'Financial',
 'Manufactured': 'Intellectual',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the category of "Intellectual"." => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: problems retaining key personnel" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Geographic" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Classified board of directors." => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.606, -0.545, -0.478
guideline_match_Human_Social and relationship: 0.211, 0.447, 0.632
guideline_match_Intellectual_Manufactured: -0.167, -0.048, 0.024
guideline_match_Manufactured_Human: -0.049, 0.049, 0.171
guideline_match_Natural_Natural: 0.032, 0.419, 0.677
guideline_match_Social and relationship_Financial: -0.475, -0.325, -0.200
guideline_match: -0.373, -0.317, -0.260

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.351, 1.419, 1.498
tokens_per_sample: 1.363, 1.437, 1.559
fkgl_readability: 22.290, 23.185, 24.109

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.519, 0.600, 0.720
exact_match: 0.370, 0.411, 0.454
partial_match: 0.370, 0.411, 0.454
INFO:__main__:Processing label permutation 21 of 60:
{'Financial': 'Intellectual',
 'Human': 'Manufactured',
 'Intellectual': 'Natural',
 'Manufactured': 'Social and relationship',
 'Natural': 'Human',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sus ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Natural: Risk management" => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Natural - Workforce" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.696, -0.646, -0.594
guideline_match_Human_Natural: -0.211, -0.079, -0.026
guideline_match_Intellectual_Financial: -0.190, 0.048, 0.286
guideline_match_Manufactured_Human: -0.317, -0.171, -0.073
guideline_match_Natural_Intellectual: -0.161, 0.032, 0.226
guideline_match_Social and relationship_Manufactured: -0.425, -0.125, 0.175
guideline_match: -0.487, -0.437, -0.385

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.011, 1.052, 1.213
tokens_per_sample: 1.011, 1.052, 1.213
fkgl_readability: 25.264, 26.074, 26.919

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.307, 0.378, 0.515
exact_match: 0.389, 0.431, 0.472
partial_match: 0.389, 0.431, 0.472
INFO:__main__:Processing label permutation 22 of 60:
{'Financial': 'Natural',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Human',
 'Natural': 'Manufactured',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and '
 ' ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Natural" category." => "Natural"
WARNING:llms.classifiers.models:Prediction "Social and relationship: Monetary resources, assets, liabilities, revenues, expenses, or any other financial information related to the company's operations, investments, and financial performance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text deals with legislation related to the company's operations and financial performance, such as restrictions on the sale of energy drinks, caffeine content limits, and requirements for certain governmental programs." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text pertains to monetary resources (slotting, shelf space allowances, and other fees) given directly to retailers, which is a financial aspect of the company's operations." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text pertains to monetary resources (pension plans), liabilities (participants' accounts in the Qualified Replacement Plan), revenues (employer contributions), and expenses (administrative costs related to the Terminated Plan and the Qualified Replacement Plan)." => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.501, -0.432, -0.357
guideline_match_Human_Manufactured: 0.105, 0.237, 0.395
guideline_match_Intellectual_Intellectual: 0.333, 0.619, 0.810
guideline_match_Manufactured_Natural: 0.195, 0.317, 0.463
guideline_match_Natural_Financial: 0.097, 0.194, 0.355
guideline_match_Social and relationship_Human: -0.300, -0.100, 0.100
guideline_match: -0.246, -0.184, -0.119

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.439, 1.800
tokens_per_sample: 1.274, 1.439, 1.800
fkgl_readability: 21.931, 22.639, 23.366

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.443, 0.602, 0.950
exact_match: 0.411, 0.452, 0.496
partial_match: 0.413, 0.456, 0.498
INFO:__main__:Processing label permutation 23 of 60:
{'Financial': 'Human',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that addresses environmental '
 'resourc ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that addresses environmental '
 'res ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Relentless® - a line of carbonated energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, communities, customers, suppliers, partners, and any other social or relationship-based assets that affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including consumer use and acceptance of electronic payment methods." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including suppliers and partners, which affect its operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: •censorship requirements that cause us to remove or edit popular content, leading to consumer disappointment, brand tarnishment or dissatisfaction with our service." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text deals with legislation related to the company's use of natural resources and its environmental responsibility, which falls under the social and relationship category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Ultra Energy® - a line of carbonated energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.658, -0.600, -0.539
guideline_match_Human_Financial: -0.183, -0.053, 0.000
guideline_match_Intellectual_Intellectual: 0.238, 0.524, 0.762
guideline_match_Manufactured_Human: -0.780, -0.634, -0.463
guideline_match_Natural_Social and relationship: -0.258, -0.097, 0.065
guideline_match_Social and relationship_Natural: -0.100, 0.175, 0.425
guideline_match: -0.445, -0.389, -0.329

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.133, 1.206, 1.457
tokens_per_sample: 1.133, 1.206, 1.457
fkgl_readability: 19.970, 20.606, 21.301

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.350, 0.435, 0.670
exact_match: 0.409, 0.452, 0.493
partial_match: 0.409, 0.452, 0.493
INFO:__main__:Processing label permutation 24 of 60:
{'Financial': 'Intellectual',
 'Human': 'Manufactured',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Human',
 'Natural': 'Natural',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Manufactured: A sentence that involves information about the company's "
 'w ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Manufactured: A sentence that involves information about the company's " ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text refers to physical assets (construction of a mixed-feed cracker and associated polyethylene unit) that contribute to the company's value." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text refers to "pending and ongoing litigation" and "negotiations between certain CMOs and other third parties," which are related to the company's workforce and human resources." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human:
The text pertains to the company's workforce, including employees, skills, expertise, training, recruitment, and talent development, which are all aspects of the company's human resources." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Legislation, regulation, and other government actions related to greenhouse gas (GHG) emissions and climate change could increase Chevron’s operational costs and reduce demand for its hydrocarbon and other products." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text deals with the impact of a breach on the company's relationships with its workforce, including employees and potential members." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human - Other Intangibles" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Human:
The text pertains to the company's responsibility towards its members' personal computers and other devices, and the potential impact of software used in operations on the company's business, results of operations, and financial condition. Therefore, it falls under the category of "Human"." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text refers to the company's workforce, skills, expertise, training, and talent development, which are all aspects of human resources that contribute to the company's success." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Terminated Plan and Qualified Replacement Plan are both related to the company's workforce, specifically regarding employee benefits and retirement plans." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text refers to the impact of the COVID-19 pandemic on the company's workforce, including employees, skills, expertise, training, recruitment, and talent development." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Human: The text mentions the impact of the COVID-19 pandemic on Chevron's workforce, including a decrease in demand for the company's products and a potential adverse effect on its financial and operating results." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human: The text refers to the cost of complying with laws, regulations, and requirements related to employee safety and environmental protection, which falls under the category of "Human."" => "Human"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.588, -0.536, -0.481
guideline_match_Human_Manufactured: 0.079, 0.237, 0.421
guideline_match_Intellectual_Financial: 0.000, 0.167, 0.333
guideline_match_Manufactured_Human: -0.146, -0.024, 0.073
guideline_match_Natural_Natural: 0.032, 0.419, 0.677
guideline_match_Social and relationship_Intellectual: -0.450, -0.175, 0.150
guideline_match: -0.359, -0.305, -0.248

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.019, 1.136, 1.449
tokens_per_sample: 1.019, 1.187, 1.620
fkgl_readability: 25.588, 26.477, 27.379

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.326, 0.491, 0.920
exact_match: 0.393, 0.435, 0.478
partial_match: 0.394, 0.437, 0.480
INFO:__main__:Processing label permutation 25 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Intellectual',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'l ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text you provided, the category would be:
Concept: Technological" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that pertains to the company's legal rights, obligations, and disputes related to its operations and licensing agreements." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Cultural:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human

The text mentions "Shelley L. Reynolds," which indicates that it pertains to information about a specific person, in this case, a person named Shelley Reynolds. As this information is related to the company's workforce and human resources, it falls under the category of "Human."" => "Human"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.762, 0.832, 0.884
guideline_match_Human_Human: 0.684, 0.895, 1.000
guideline_match_Intellectual_Manufactured: -0.167, -0.048, 0.048
guideline_match_Manufactured_Intellectual: -0.512, -0.341, -0.195
guideline_match_Natural_Social and relationship: -0.097, 0.065, 0.226
guideline_match_Social and relationship_Natural: -0.750, -0.550, -0.300
guideline_match: 0.466, 0.531, 0.592

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.004, 1.013
tokens_per_sentence: 1.049, 1.111, 1.303
tokens_per_sample: 1.057, 1.143, 1.341
fkgl_readability: 21.100, 21.760, 22.483

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.004, 0.013
tokens_diff: 0.343, 0.439, 0.615
exact_match: 0.354, 0.394, 0.437
partial_match: 0.354, 0.394, 0.437
INFO:__main__:Processing label permutation 26 of 60:
{'Financial': 'Natural',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and '
 ' ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Natural
This text falls under the category of "Manufactured" as it relates to monetary resources, assets, liabilities, revenues, expenses, or any other financial information related to the company's operations, investments, and financial performance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.020, 0.107, 0.191
guideline_match_Human_Human: 0.684, 0.895, 1.000
guideline_match_Intellectual_Intellectual: 0.238, 0.524, 0.762
guideline_match_Manufactured_Natural: 0.171, 0.293, 0.439
guideline_match_Natural_Financial: 0.097, 0.194, 0.355
guideline_match_Social and relationship_Social and relationship: 0.350, 0.650, 0.850
guideline_match: 0.186, 0.255, 0.320

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.133, 1.226, 1.608
tokens_per_sample: 1.133, 1.226, 1.608
fkgl_readability: 23.202, 23.947, 24.710

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.320, 0.419, 0.776
exact_match: 0.417, 0.457, 0.502
partial_match: 0.417, 0.457, 0.502
INFO:__main__:Processing label permutation 27 of 60:
{'Financial': 'Financial',
 'Human': 'Natural',
 'Intellectual': 'Human',
 'Manufactured': 'Intellectual',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that relates to intangible assets, knowledge, '
 'i ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that relates to intangible assets, knowledge, ' ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Risk" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Manufactured" category." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Financial" category." => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.148, -0.038, 0.067
guideline_match_Human_Intellectual: 0.184, 0.368, 0.526
guideline_match_Intellectual_Manufactured: 0.238, 0.381, 0.548
guideline_match_Manufactured_Natural: 0.049, 0.122, 0.244
guideline_match_Natural_Human: -0.323, -0.161, -0.032
guideline_match_Social and relationship_Social and relationship: -0.750, -0.550, -0.250
guideline_match: -0.084, -0.009, 0.069

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.030, 1.056, 1.120
tokens_per_sample: 1.033, 1.074, 1.219
fkgl_readability: 25.901, 26.683, 27.467

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.293, 0.363, 0.485
exact_match: 0.385, 0.428, 0.469
partial_match: 0.385, 0.428, 0.469
INFO:__main__:Processing label permutation 28 of 60:
{'Financial': 'Human',
 'Human': 'Intellectual',
 'Intellectual': 'Financial',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that relates to intangible assets, knowledge, '
 'intellec ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that relates to intangible assets, knowledge, '
 'inte ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text you provided, the category would be:
Concept: Risk" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human: difficulty integrating under the commercial agreements" => "Human"
WARNING:llms.classifiers.models:Prediction "Human: The text mentions the importance of developing resources and the company's success in replacing produced crude oil and natural gas, which relates to intangible assets such as knowledge, intellectual property, and research and development activities." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human - Partitioned Zone Chevron holds a concession to operate the Kingdom of Saudi Arabia's 50 percent interest in the hydrocarbon resources in the onshore area of the Partitioned Zone between Saudi Arabia and Kuwait." => "Human"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text you provided, the category would be:
Intangible: Other unknown or unpredictable factors" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Financial" category." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Decisions by suppliers..." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Human - Intellectual" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.493, -0.423, -0.351
guideline_match_Human_Financial: -0.157, -0.026, 0.000
guideline_match_Intellectual_Human: 0.429, 0.571, 0.714
guideline_match_Manufactured_Manufactured: -0.268, 0.024, 0.317
guideline_match_Natural_Natural: 0.161, 0.484, 0.742
guideline_match_Social and relationship_Social and relationship: -0.150, 0.150, 0.450
guideline_match: -0.255, -0.188, -0.123

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.004, 1.013
tokens_per_sentence: 1.120, 1.217, 1.574
tokens_per_sample: 1.133, 1.252, 1.580
fkgl_readability: 16.640, 17.581, 18.584

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.004, 0.013
tokens_diff: 0.346, 0.470, 0.787
exact_match: 0.356, 0.396, 0.437
partial_match: 0.357, 0.398, 0.441
INFO:__main__:Processing label permutation 29 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Intellectual',
 'Natural': 'Natural',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainability ' ... '
 "company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainabili ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Risk" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Intellectual" category." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Cultural:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship:
The text relates to the company's property, which is a tangible asset that contributes to the company's value. Therefore, it falls under the category of "Social and relationship."" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Geographic" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.009, 0.096, 0.200
guideline_match_Human_Human: 0.526, 0.789, 0.947
guideline_match_Intellectual_Manufactured: -0.024, 0.071, 0.190
guideline_match_Manufactured_Social and relationship: -0.585, -0.415, -0.244
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Intellectual: -0.575, -0.325, -0.025
guideline_match: 0.046, 0.125, 0.204

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.004, 1.013
tokens_per_sentence: 1.023, 1.056, 1.131
tokens_per_sample: 1.026, 1.091, 1.254
fkgl_readability: 22.688, 23.553, 24.439

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.004, 0.013
tokens_diff: 0.333, 0.417, 0.572
exact_match: 0.411, 0.454, 0.496
partial_match: 0.411, 0.454, 0.496
INFO:__main__:Processing label permutation 30 of 60:
{'Financial': 'Human',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Natural',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that relates to intangible assets, knowledge, '
 'i ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that relates to intangible assets, knowledge, ' ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.412, -0.351, -0.287
guideline_match_Human_Financial: -0.237, -0.105, -0.026
guideline_match_Intellectual_Intellectual: nan, 1.000, nan
guideline_match_Manufactured_Social and relationship: -0.122, -0.024, 0.049
guideline_match_Natural_Natural: 0.290, 0.613, 0.806
guideline_match_Social and relationship_Human: -0.150, 0.150, 0.450
guideline_match: -0.171, -0.110, -0.048

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.000, 1.004, 1.022
tokens_per_sample: 1.000, 1.004, 1.022
fkgl_readability: 27.506, 28.555, 29.626

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.278, 0.337, 0.404
exact_match: 0.393, 0.435, 0.478
partial_match: 0.393, 0.435, 0.478
INFO:__main__:Processing label permutation 31 of 60:
{'Financial': 'Intellectual',
 'Human': 'Human',
 'Intellectual': 'Natural',
 'Manufactured': 'Financial',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that pertains to monetary resources, assets, '
 'li ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that pertains to monetary resources, assets, '
 ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Cultural:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.159, 0.241, 0.319
guideline_match_Human_Human: 0.634, 0.895, 1.000
guideline_match_Intellectual_Financial: -0.143, 0.095, 0.310
guideline_match_Manufactured_Natural: 0.122, 0.220, 0.366
guideline_match_Natural_Intellectual: -0.032, 0.065, 0.194
guideline_match_Social and relationship_Social and relationship: -0.750, -0.550, -0.250
guideline_match: 0.140, 0.205, 0.268

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.019, 1.037, 1.065
tokens_per_sample: 1.019, 1.037, 1.065
fkgl_readability: 23.599, 24.271, 24.968

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.274, 0.333, 0.400
exact_match: 0.361, 0.402, 0.444
partial_match: 0.361, 0.402, 0.444
INFO:__main__:Processing label permutation 32 of 60:
{'Financial': 'Intellectual',
 'Human': 'Human',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Natural',
 'Natural': 'Financial',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that pertains to monetary resources, assets, '
 'liabili ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that pertains to monetary resources, assets, '
 'lia ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: 0.458, 0.525, 0.588
guideline_match_Human_Human: 0.737, 0.947, 1.000
guideline_match_Intellectual_Financial: -0.024, 0.167, 0.357
guideline_match_Manufactured_Intellectual: -0.659, -0.463, -0.244
guideline_match_Natural_Manufactured: -0.161, 0.000, 0.161
guideline_match_Social and relationship_Social and relationship: 0.450, 0.750, 0.900
guideline_match: 0.377, 0.437, 0.494

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.163, 1.222, 1.363
tokens_per_sample: 1.163, 1.222, 1.363
fkgl_readability: 19.732, 20.321, 21.001

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.300, 0.370, 0.507
exact_match: 0.393, 0.435, 0.476
partial_match: 0.393, 0.435, 0.476
INFO:__main__:Processing label permutation 33 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text mentions information about the company's workforce, including employees, skills, expertise, training, recruitment, and talent development." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text mentions difficulties integrating under commercial agreements, which relates to the company's relationships and interactions with external stakeholders, communities, customers, suppliers, and partners." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Legal: Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Censorship requirements that cause the company to remove or edit popular content leading to consumer disappointment, brand tarnishment, or dissatisfaction with the service." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with legislation related to the sale of energy drinks and its impact on the company's operations and reputation, involving information about the company's interactions with external stakeholders, including government agencies." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's policies and processes related to its workforce, including preventing fraudulent activities by sellers and ensuring compliance with proprietary rights." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: problems retaining key personnel" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Ultra Energy® - a line of carbonated energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Human:
The text mentions "critical systems and infrastructure," "people," "harm to the environment," "assets," "access to financial reporting systems," and "critical data and proprietary information." These are all categories of human assets that are relevant to the company's operations and security." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's board of directors, which is a social and relationship-based aspect of the company's operations." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.377, -0.313, -0.252
guideline_match_Human_Social and relationship: 0.421, 0.579, 0.737
guideline_match_Intellectual_Intellectual: 0.238, 0.524, 0.762
guideline_match_Manufactured_Human: -0.439, -0.293, -0.171
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Financial: -0.350, -0.175, 0.000
guideline_match: -0.154, -0.097, -0.035

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.285, 1.365, 1.594
tokens_per_sample: 1.291, 1.422, 1.920
fkgl_readability: 20.341, 20.984, 21.699

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.480, 0.615, 1.101
exact_match: 0.404, 0.444, 0.485
partial_match: 0.404, 0.444, 0.485
INFO:__main__:Processing label permutation 34 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Human',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that refers to physical assets, infrastructure, '
  ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that refers to physical assets, infrastructure, ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including government agencies, and addresses legal restrictions on the sale of energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.397, -0.299, -0.194
guideline_match_Human_Manufactured: -0.132, -0.026, 0.000
guideline_match_Intellectual_Human: 0.286, 0.429, 0.595
guideline_match_Manufactured_Intellectual: -0.049, 0.073, 0.220
guideline_match_Natural_Natural: 0.355, 0.677, 0.871
guideline_match_Social and relationship_Social and relationship: 0.350, 0.650, 0.850
guideline_match: -0.142, -0.067, 0.009

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.119, 1.159, 1.207
tokens_per_sample: 1.119, 1.159, 1.207
fkgl_readability: 26.693, 27.819, 28.903

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.263, 0.322, 0.389
exact_match: 0.402, 0.444, 0.487
partial_match: 0.402, 0.444, 0.487
INFO:__main__:Processing label permutation 35 of 60:
{'Financial': 'Intellectual',
 'Human': 'Human',
 'Intellectual': 'Financial',
 'Manufactured': 'Natural',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforc ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Social and Relationship" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.400, -0.325, -0.243
guideline_match_Human_Human: nan, 1.000, nan
guideline_match_Intellectual_Financial: 0.024, 0.071, 0.190
guideline_match_Manufactured_Natural: 0.098, 0.268, 0.439
guideline_match_Natural_Manufactured: -0.161, -0.032, 0.065
guideline_match_Social and relationship_Social and relationship: -0.900, -0.700, -0.400
guideline_match: -0.227, -0.166, -0.101

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.015, 1.033, 1.059
tokens_per_sample: 1.015, 1.033, 1.059
fkgl_readability: 21.077, 22.107, 23.162

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.270, 0.330, 0.396
exact_match: 0.439, 0.481, 0.524
partial_match: 0.439, 0.481, 0.524
INFO:__main__:Processing label permutation 36 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that relates to intangible assets, knowledge, '
 'i ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that relates to intangible assets, knowledge, ' ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Intellectual'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Social and relationship: Monetary resources, assets, liabilities, revenues, expenses, or any other financial information related to the company's operations, investments, and financial performance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, I would classify it under the "Geographic" category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.684, -0.632, -0.574
guideline_match_Human_Human: 0.579, 0.842, 0.947
guideline_match_Intellectual_Intellectual: nan, 1.000, nan
guideline_match_Manufactured_Financial: -0.537, -0.317, -0.073
guideline_match_Natural_Natural: 0.161, 0.484, 0.742
guideline_match_Social and relationship_Manufactured: -0.650, -0.500, -0.350
guideline_match: -0.368, -0.301, -0.234

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.101, 1.179, 1.431
tokens_per_sample: 1.107, 1.196, 1.448
fkgl_readability: 30.287, 31.468, 32.613

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.307, 0.404, 0.637
exact_match: 0.393, 0.435, 0.476
partial_match: 0.394, 0.437, 0.478
INFO:__main__:Processing label permutation 37 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Natural',
 'Manufactured': 'Manufactured',
 'Natural': 'Human',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sus ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal: Liability and risk management." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.304, -0.200, -0.096
guideline_match_Human_Natural: -0.132, -0.026, 0.053
guideline_match_Intellectual_Human: 0.214, 0.381, 0.548
guideline_match_Manufactured_Manufactured: 0.756, 0.951, 1.000
guideline_match_Natural_Intellectual: -0.258, 0.000, 0.258
guideline_match_Social and relationship_Social and relationship: -0.900, -0.750, -0.500
guideline_match: -0.158, -0.084, -0.006

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.022, 1.069, 1.225
tokens_per_sample: 1.022, 1.069, 1.225
fkgl_readability: 26.951, 27.951, 28.930

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.291, 0.361, 0.496
exact_match: 0.378, 0.419, 0.461
partial_match: 0.378, 0.419, 0.461
INFO:__main__:Processing label permutation 38 of 60:
{'Financial': 'Financial',
 'Human': 'Social and relationship',
 'Intellectual': 'Human',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainability ' ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainabili ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Risk: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Natural" category." => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Legal: Liability or delays could result from an accidental, unlawful discharge or from new conclusions about the effects of the company's operations on human health or the environment." => "Human"
WARNING:llms.classifiers.models:Prediction "Cultural:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.229, -0.125, -0.014
guideline_match_Human_Intellectual: -0.079, 0.026, 0.158
guideline_match_Intellectual_Social and relationship: -0.190, -0.071, 0.048
guideline_match_Manufactured_Manufactured: 0.561, 0.805, 0.951
guideline_match_Natural_Natural: 0.484, 0.806, 0.935
guideline_match_Social and relationship_Human: -0.300, 0.000, 0.300
guideline_match: -0.054, 0.024, 0.102

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.013, 1.032, 1.091
tokens_per_sample: 1.015, 1.048, 1.180
fkgl_readability: 23.518, 24.281, 25.082

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.302, 0.367, 0.480
exact_match: 0.427, 0.469, 0.511
partial_match: 0.427, 0.469, 0.511
INFO:__main__:Processing label permutation 39 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforc ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Intellectual" category." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including customers, suppliers, partners, and environmental resources, which affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Human: difficulty integrating under the commercial agreements" => "Human"
WARNING:llms.classifiers.models:Prediction "Social and relationship:
The text deals with the company's interactions with government entities and the impact of government actions on its operations and financial performance, which falls under the category of social and relationship assets." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Environmental investigation and remediation activities." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Low carbon fuel standard obligations" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.032, 0.072, 0.177
guideline_match_Human_Human: nan, 1.000, nan
guideline_match_Intellectual_Intellectual: nan, 1.000, nan
guideline_match_Manufactured_Manufactured: 0.268, 0.561, 0.756
guideline_match_Natural_Social and relationship: -0.097, 0.065, 0.226
guideline_match_Social and relationship_Natural: -0.925, -0.825, -0.650
guideline_match: 0.099, 0.181, 0.259

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.038, 1.119, 1.475
tokens_per_sample: 1.041, 1.135, 1.447
fkgl_readability: 20.901, 21.846, 22.829

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.315, 0.420, 0.701
exact_match: 0.470, 0.513, 0.554
partial_match: 0.470, 0.513, 0.554
INFO:__main__:Processing label permutation 40 of 60:
{'Financial': 'Financial',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Human',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that deals with the company's relationships and "
 'intera ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that deals with the company's relationships and "
 'in ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Natural" => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Social and Relationship" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Shelley L. Reynolds" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.107, -0.003, 0.101
guideline_match_Human_Natural: -0.157, -0.026, 0.000
guideline_match_Intellectual_Intellectual: 0.095, 0.381, 0.619
guideline_match_Manufactured_Manufactured: -0.122, 0.171, 0.463
guideline_match_Natural_Social and relationship: 0.097, 0.226, 0.387
guideline_match_Social and relationship_Human: 0.475, 0.650, 0.800
guideline_match: 0.022, 0.100, 0.178

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.127, 1.173, 1.235
tokens_per_sample: 1.137, 1.189, 1.306
fkgl_readability: 17.527, 18.241, 19.002

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.365, 0.437, 0.550
exact_match: 0.415, 0.457, 0.500
partial_match: 0.415, 0.457, 0.500
INFO:__main__:Processing label permutation 41 of 60:
{'Financial': 'Natural',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Financial',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 'relati ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 're ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Natural'
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Technology/Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text you provided, the category would be:
Social" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: 0.235, 0.328, 0.414
guideline_match_Human_Human: 0.526, 0.789, 0.947
guideline_match_Intellectual_Intellectual: 0.238, 0.524, 0.762
guideline_match_Manufactured_Manufactured: -0.561, -0.268, 0.024
guideline_match_Natural_Financial: -0.065, 0.032, 0.161
guideline_match_Social and relationship_Social and relationship: 0.500, 0.750, 0.900
guideline_match: 0.270, 0.345, 0.415

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.393, 1.464, 1.542
tokens_per_sample: 1.404, 1.478, 1.581
fkgl_readability: 18.756, 19.399, 20.106

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.440, 0.515, 0.615
exact_match: 0.385, 0.426, 0.469
partial_match: 0.385, 0.426, 0.469
INFO:__main__:Processing label permutation 42 of 60:
{'Financial': 'Financial',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the  ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Concept: Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text involves information about the company's workforce, including employees, skills, expertise, training, recruitment, and talent development." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Social and relationship: The text refers to the company's difficulty in integrating under commercial agreements, which is a human resources issue related to the company's workforce and relationships with external stakeholders." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The Company's agreed share of slotting, shelf space allowances and other fees given directly to retailers." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Products – Monster Energy® Drinks Segment" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Human: As our agreements terminate, we may be unable to renew or replace these agreements on comparable terms, or at all." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Social and relationship:
The text relates to the company's governance structure, specifically the composition of the board of directors, which is a human resource aspect that contributes to the company's success." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.345, -0.246, -0.142
guideline_match_Human_Social and relationship: 0.316, 0.526, 0.684
guideline_match_Intellectual_Intellectual: 0.762, 0.952, 1.000
guideline_match_Manufactured_Human: -0.098, 0.000, 0.098
guideline_match_Natural_Natural: 0.290, 0.613, 0.871
guideline_match_Social and relationship_Manufactured: -0.500, -0.300, -0.100
guideline_match: -0.110, -0.034, 0.045

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.293, 1.424, 1.726
tokens_per_sample: 1.293, 1.424, 1.726
fkgl_readability: 21.808, 22.725, 23.642

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.507, 0.639, 0.931
exact_match: 0.420, 0.463, 0.506
partial_match: 0.424, 0.467, 0.509
INFO:__main__:Processing label permutation 43 of 60:
{'Financial': 'Financial',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'l ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text you provided, the category would be:
Concept: Technological" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that pertains to the company's legal rights, obligations, and disputes related to its operations, including litigation, contracts, and regulatory compliance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:
The text pertains to the legal framework surrounding online service providers and their liability, which falls under the category of "Legal."" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that pertains to the company's legal rights, obligations, and disputes related to its operations, products, and services." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.557, 0.641, 0.716
guideline_match_Human_Social and relationship: 0.053, 0.158, 0.289
guideline_match_Intellectual_Intellectual: 0.667, 0.905, 1.000
guideline_match_Manufactured_Manufactured: 0.659, 0.902, 1.000
guideline_match_Natural_Natural: -0.097, 0.226, 0.548
guideline_match_Social and relationship_Human: 0.000, 0.300, 0.600
guideline_match: 0.529, 0.596, 0.657

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.096, 1.231, 1.526
tokens_per_sample: 1.106, 1.246, 1.541
fkgl_readability: 22.138, 22.884, 23.645

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.415, 0.561, 0.843
exact_match: 0.348, 0.391, 0.432
partial_match: 0.348, 0.391, 0.432
INFO:__main__:Processing label permutation 44 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Natural',
 'Manufactured': 'Manufactured',
 'Natural': 'Intellectual',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 'relati ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 're ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Relentless®" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
**Security**" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The company's relationships and interactions with external stakeholders, communities, customers, suppliers, partners, and any other social or relationship-based assets that affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, specifically regarding commercial agreements." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including stockholders." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including government agencies and communities." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including co-packers, which affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Social and relationship" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Ultra Energy® - a line of carbonated energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Products – Monster Energy® Drinks Segment" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.148, 0.252, 0.357
guideline_match_Human_Human: 0.579, 0.842, 0.947
guideline_match_Intellectual_Natural: -0.333, -0.190, -0.095
guideline_match_Manufactured_Manufactured: 0.512, 0.756, 0.902
guideline_match_Natural_Intellectual: -0.290, -0.097, 0.097
guideline_match_Social and relationship_Social and relationship: 0.750, 0.950, 1.000
guideline_match: 0.249, 0.328, 0.401

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.491, 1.575, 1.717
tokens_per_sample: 1.500, 1.594, 1.763
fkgl_readability: 19.222, 19.930, 20.709

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.498, 0.594, 0.761
exact_match: 0.419, 0.461, 0.504
partial_match: 0.419, 0.461, 0.504
INFO:__main__:Processing label permutation 45 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforc ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal: This sentence pertains to the company's legal responsibilities, potential costs and liabilities related to litigation, and compliance with laws and regulations." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text you provided, the category would be:
Concept: Unknown or unpredictable factors" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.328, -0.223, -0.119
guideline_match_Human_Human: nan, 1.000, nan
guideline_match_Intellectual_Intellectual: 0.524, 0.762, 0.905
guideline_match_Manufactured_Manufactured: 0.756, 0.951, 1.000
guideline_match_Natural_Natural: 0.290, 0.613, 0.806
guideline_match_Social and relationship_Social and relationship: -0.650, -0.400, -0.100
guideline_match: -0.022, 0.065, 0.148

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.076, 1.161, 1.376
tokens_per_sample: 1.083, 1.180, 1.403
fkgl_readability: 22.174, 23.072, 23.991

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.326, 0.435, 0.648
exact_match: 0.431, 0.474, 0.517
partial_match: 0.431, 0.474, 0.517
INFO:__main__:Processing label permutation 46 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Human',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that refers to physical assets, infrastructure, '
  ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that refers to physical assets, infrastructure, ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Social and Relationship" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
* Natural: Impact on environment and ecological sustainability." => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Legal: A sentence that pertains to the company's legal issues, including claims, litigation, reviews, investigations, and other proceedings related to patent and intellectual property matters, taxes, labor and employment, competition and antitrust, privacy, data protection, data security, network security, consumer protection, commercial disputes, and other legal issues." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Sure! Based on the text provided, the concept category that best fits is:
Technology" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.159, 0.264, 0.362
guideline_match_Human_Intellectual: -0.053, 0.026, 0.132
guideline_match_Intellectual_Human: -0.143, 0.048, 0.238
guideline_match_Manufactured_Manufactured: nan, 1.000, nan
guideline_match_Natural_Natural: 0.226, 0.548, 0.806
guideline_match_Social and relationship_Social and relationship: -0.850, -0.650, -0.350
guideline_match: 0.156, 0.234, 0.310

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.004, 1.013
tokens_per_sentence: 1.030, 1.061, 1.126
tokens_per_sample: 1.035, 1.093, 1.237
fkgl_readability: 22.914, 23.644, 24.424

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.004, 0.013
tokens_diff: 0.307, 0.385, 0.524
exact_match: 0.393, 0.433, 0.474
partial_match: 0.393, 0.433, 0.474
INFO:__main__:Processing label permutation 47 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Natural',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'l ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal: A sentence that deals with the company's legal issues, such as litigation, negotiations, and contractual agreements." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept can be classified under the category of "Intellectual."" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.554, 0.641, 0.716
guideline_match_Human_Human: 0.579, 0.842, 0.947
guideline_match_Intellectual_Intellectual: 0.333, 0.619, 0.810
guideline_match_Manufactured_Natural: 0.195, 0.390, 0.561
guideline_match_Natural_Manufactured: -0.065, 0.032, 0.161
guideline_match_Social and relationship_Social and relationship: 0.150, 0.450, 0.700
guideline_match: 0.516, 0.583, 0.640

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.119, 1.196, 1.384
tokens_per_sample: 1.119, 1.196, 1.384
fkgl_readability: 20.552, 21.179, 21.873

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.323, 0.411, 0.581
exact_match: 0.394, 0.435, 0.478
partial_match: 0.394, 0.435, 0.478
INFO:__main__:Processing label permutation 48 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforc ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Human: Decisions by suppliers..." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.464, -0.397, -0.325
guideline_match_Human_Human: nan, 1.000, nan
guideline_match_Intellectual_Intellectual: 0.571, 0.810, 0.952
guideline_match_Manufactured_Financial: -0.415, -0.268, -0.146
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Social and relationship: -0.350, -0.050, 0.250
guideline_match: -0.156, -0.087, -0.019

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.069, 1.100, 1.143
tokens_per_sample: 1.069, 1.100, 1.143
fkgl_readability: 19.549, 20.407, 21.343

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.263, 0.322, 0.387
exact_match: 0.478, 0.520, 0.561
partial_match: 0.478, 0.520, 0.561
INFO:__main__:Processing label permutation 49 of 60:
{'Financial': 'Financial',
 'Human': 'Natural',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Human',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Natural: A sentence that involves information about the company's "
 'workfo ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Natural: A sentence that involves information about the company's "
 'wo ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Natural" category." => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: Proposed and/or adopted legislation related to the sale of energy drinks and caffeine content." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.014, 0.119, 0.223
guideline_match_Human_Natural: 0.000, 0.026, 0.158
guideline_match_Intellectual_Intellectual: 0.714, 0.905, 1.000
guideline_match_Manufactured_Manufactured: 0.122, 0.415, 0.659
guideline_match_Natural_Human: 0.097, 0.194, 0.355
guideline_match_Social and relationship_Social and relationship: -0.700, -0.450, -0.150
guideline_match: 0.080, 0.158, 0.236

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.044, 1.083, 1.211
tokens_per_sample: 1.044, 1.083, 1.211
fkgl_readability: 20.290, 21.098, 21.965

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.270, 0.335, 0.444
exact_match: 0.441, 0.483, 0.524
partial_match: 0.441, 0.483, 0.524
INFO:__main__:Processing label permutation 50 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Intellectual',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 'relati ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 're ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Relentless®" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The company's relationships and interactions with external stakeholders, communities, customers, suppliers, partners, and any other social or relationship-based assets that affect the company's operations and reputation." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Predator®" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, specifically regarding commercial agreements." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including stockholders." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Java Monster® 300 Mocha" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Concept: Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Ultra Energy® - a line of carbonated energy drinks." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The Company's agreed share of slotting, shelf space allowances and other fees given directly to retailers." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Products – Monster Energy® Drinks Segment" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: Shelley L. Reynolds" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship: The text deals with the company's relationships and interactions with external stakeholders, including the board of directors." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social" => "Social and relationship"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: -0.142, -0.038, 0.072
guideline_match_Human_Human: 0.634, 0.895, 1.000
guideline_match_Intellectual_Manufactured: -0.310, -0.143, 0.024
guideline_match_Manufactured_Intellectual: -0.537, -0.390, -0.244
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Social and relationship: 0.400, 0.700, 0.900
guideline_match: 0.030, 0.108, 0.186

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.296, 1.367, 1.511
tokens_per_sample: 1.296, 1.367, 1.511
fkgl_readability: 19.410, 20.042, 20.714

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.367, 0.441, 0.574
exact_match: 0.465, 0.506, 0.548
partial_match: 0.465, 0.506, 0.548
INFO:__main__:Processing label permutation 51 of 60:
{'Financial': 'Human',
 'Human': 'Financial',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating llama-2-7b-chat on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.LlamaChatClassifier'>
INFO:llms.models.huggingface:Loading tokenizer /mnt/data/models/llama2/hf/7b-chat/...
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 396.22407407407405,
 'mean_truncation': -3443.775925925926,
 'total_tokens': 213961,
 'total_truncation': -1859639}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainability ' ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{'dtype': torch.float16}
INFO:llms.models.base:Generation kwargs:
{'input_length_adjust': -1,
 'keep_generated_only': True,
 'max_new_tokens': 256,
 'memoizer_ignore_cache': False,
 'seed': 17,
 'temperature': 0.8}
INFO:llms.models.base:Model input:
('[INST] Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainabili ... erbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.\n'
 'Concept: [/INST]')
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Social and Relationship" => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, I would classify it under the "Natural" category." => "Natural"
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal:" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category that best fits is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal: Negligence, copyright and trademark infringement, or other claims based on the nature and content of materials." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the category is:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text you provided, the category would be:
Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Sure! Based on the text provided, the concept category would be:
Financial" => "Financial"
WARNING:llms.metrics:Ignoring 195 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 498 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 499 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 509 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 500 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 1 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.496, -0.441, -0.386
guideline_match_Human_Financial: -0.237, -0.105, -0.026
guideline_match_Intellectual_Intellectual: 0.619, 0.857, 0.952
guideline_match_Manufactured_Manufactured: 0.512, 0.756, 0.902
guideline_match_Natural_Natural: 0.613, 0.871, 1.000
guideline_match_Social and relationship_Social and relationship: 0.300, 0.600, 0.800
guideline_match: -0.135, -0.071, -0.004

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.157, 1.215, 1.359
tokens_per_sample: 1.157, 1.215, 1.359
fkgl_readability: 21.325, 22.024, 22.791

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.302, 0.370, 0.507
exact_match: 0.452, 0.494, 0.537
partial_match: 0.452, 0.494, 0.537
INFO:__main__:No permutations remaining. Exiting loop.
INFO:__main__:Correlation with permutation_edit_distance:
permutation_edit_distance      1.000000
permutation_rouge1_distance    0.996017
permutation_rouge2_distance    0.997411
accuracy                      -0.292081
Name: permutation_edit_distance, dtype: float64
INFO:__main__:Correlation with permutation_rouge1_distance:
permutation_edit_distance      0.996017
permutation_rouge1_distance    1.000000
permutation_rouge2_distance    0.998380
accuracy                      -0.292653
Name: permutation_rouge1_distance, dtype: float64
INFO:__main__:Correlation with permutation_rouge2_distance:
permutation_edit_distance      0.997411
permutation_rouge1_distance    0.998380
permutation_rouge2_distance    1.000000
accuracy                      -0.292872
Name: permutation_rouge2_distance, dtype: float64
INFO:__main__:Permutation metric counts:
{0.0: 1,
 0.33333333333333337: 10,
 0.5: 10,
 0.6666666666666667: 10,
 0.8333333333333334: 10,
 1.0: 10}
