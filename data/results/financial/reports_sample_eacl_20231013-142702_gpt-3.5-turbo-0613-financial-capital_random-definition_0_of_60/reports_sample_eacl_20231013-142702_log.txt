INFO:__main__:Processing label permutation 0 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Financial: A sentence that pertains to mone ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "None of the categories listed above directly apply to the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "Unclassified" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Non of the provided categories fully fit the given text. However, the closest category would be "Financial" due to the mention of "quantitative data", which can be related to monetary resources and financial performance." => "Financial"
WARNING:llms.classifiers.models:Prediction "None of the categories listed above directly apply to the text provided." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
INFO:llms.metrics:classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.152, 1.211, 1.311
tokens_per_sample: 1.152, 1.211, 1.311
fkgl_readability: 23.280, 24.055, 24.895

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.315, 0.389, 0.493
exact_match: 0.391, 0.431, 0.472
partial_match: 0.391, 0.431, 0.472
INFO:__main__:Processing label permutation 1 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Natural',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Intellectual',
 'Natural': 'Human',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that pertains to monetary resources, '
  ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that pe ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Environmental" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.202, -0.153, -0.107
guideline_match_Human_Natural: -0.447, -0.211, 0.053
guideline_match_Intellectual_Manufactured: 0.317, 0.508, 0.667
guideline_match_Manufactured_Intellectual: -0.025, 0.000, 0.025
guideline_match_Natural_Human: -0.818, -0.455, 0.000
guideline_match_Social and relationship_Financial: -0.022, 0.178, 0.378
guideline_match: -0.069, -0.024, 0.020

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.104, 1.144, 1.193
tokens_per_sample: 1.104, 1.144, 1.193
fkgl_readability: 24.307, 24.968, 25.640

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.341, 0.404, 0.474
exact_match: 0.289, 0.328, 0.369
partial_match: 0.289, 0.328, 0.369
INFO:__main__:Processing label permutation 2 of 60:
{'Financial': 'Intellectual',
 'Human': 'Financial',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Human',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Natural: A sentence that deals with the company's relationships and "
 'inte ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             "- Natural: A sentence that deals with the com ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "- Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Natural" => "Natural"
WARNING:llms.classifiers.models:Prediction "This text does not fit into any of the categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "This text does not provide enough information to be classified into any of the categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.336, -0.279, -0.218
guideline_match_Human_Manufactured: -0.053, 0.158, 0.368
guideline_match_Intellectual_Financial: 0.063, 0.206, 0.349
guideline_match_Manufactured_Intellectual: -0.263, -0.161, -0.059
guideline_match_Natural_Social and relationship: 0.455, 0.818, 1.000
guideline_match_Social and relationship_Natural: 0.022, 0.178, 0.356
guideline_match: -0.153, -0.104, -0.054

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.215, 1.287, 1.413
tokens_per_sample: 1.215, 1.287, 1.413
fkgl_readability: 23.604, 24.434, 25.298

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.348, 0.428, 0.556
exact_match: 0.367, 0.407, 0.450
partial_match: 0.367, 0.407, 0.450
INFO:__main__:Processing label permutation 3 of 60:
{'Financial': 'Manufactured',
 'Human': 'Financial',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Human',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that pertains to monetary resources, assets, '
 'liabiliti ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that pertains to monetary ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Intangible" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.374, -0.313, -0.256
guideline_match_Human_Natural: -0.684, -0.526, -0.342
guideline_match_Intellectual_Intellectual: 0.143, 0.397, 0.619
guideline_match_Manufactured_Financial: -0.044, -0.008, 0.000
guideline_match_Natural_Social and relationship: -0.818, -0.455, 0.091
guideline_match_Social and relationship_Manufactured: 0.533, 0.689, 0.822
guideline_match: -0.149, -0.097, -0.043

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.093, 1.130, 1.178
tokens_per_sample: 1.093, 1.130, 1.178
fkgl_readability: 26.248, 26.991, 27.718

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.348, 0.411, 0.481
exact_match: 0.337, 0.376, 0.417
partial_match: 0.337, 0.376, 0.417
INFO:__main__:Processing label permutation 4 of 60:
{'Financial': 'Manufactured',
 'Human': 'Social and relationship',
 'Intellectual': 'Natural',
 'Manufactured': 'Financial',
 'Natural': 'Human',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that addresses env ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "It is not possible to classify the text "Shelley L. Reynolds" into any of the concept categories provided as it does not contain any relevant information or context." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.034, 0.107, 0.176
guideline_match_Human_Natural: -0.368, -0.158, 0.053
guideline_match_Intellectual_Social and relationship: 0.444, 0.603, 0.730
guideline_match_Manufactured_Financial: -0.169, -0.093, -0.025
guideline_match_Natural_Intellectual: 0.182, 0.727, 1.000
guideline_match_Social and relationship_Human: -0.156, -0.022, 0.111
guideline_match: 0.054, 0.104, 0.155

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.333, 1.419, 1.622
tokens_per_sample: 1.333, 1.419, 1.622
fkgl_readability: 23.539, 24.390, 25.243

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.441, 0.530, 0.730
exact_match: 0.311, 0.350, 0.391
partial_match: 0.311, 0.350, 0.391
INFO:__main__:Processing label permutation 5 of 60:
{'Financial': 'Human',
 'Human': 'Financial',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Intellectual',
 'Natural': 'Manufactured',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and '
 ' ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that refers to physical ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.427, -0.363, -0.294
guideline_match_Human_Financial: -0.421, -0.263, -0.105
guideline_match_Intellectual_Manufactured: 0.381, 0.508, 0.635
guideline_match_Manufactured_Natural: 0.203, 0.314, 0.424
guideline_match_Natural_Social and relationship: 0.091, 0.727, 1.000
guideline_match_Social and relationship_Intellectual: 0.311, 0.467, 0.622
guideline_match: -0.069, -0.013, 0.045

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.122, 1.163, 1.215
tokens_per_sample: 1.122, 1.163, 1.215
fkgl_readability: 24.835, 25.729, 26.631

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.330, 0.393, 0.463
exact_match: 0.402, 0.444, 0.487
partial_match: 0.402, 0.444, 0.487
INFO:__main__:Processing label permutation 6 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.405, 0.511, 0.611
guideline_match_Human_Social and relationship: 0.737, 0.947, 1.000
guideline_match_Intellectual_Human: -0.175, -0.063, 0.032
guideline_match_Manufactured_Manufactured: 0.441, 0.593, 0.729
guideline_match_Natural_Natural: -0.273, 0.455, 0.818
guideline_match_Social and relationship_Intellectual: 0.200, 0.333, 0.489
guideline_match: 0.410, 0.477, 0.540

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.252, 1.311, 1.374
tokens_per_sample: 1.252, 1.311, 1.374
fkgl_readability: 25.323, 26.201, 27.089

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.433, 0.504, 0.578
exact_match: 0.333, 0.374, 0.417
partial_match: 0.333, 0.374, 0.417
INFO:__main__:Processing label permutation 7 of 60:
{'Financial': 'Human',
 'Human': 'Intellectual',
 'Intellectual': 'Financial',
 'Manufactured': 'Social and relationship',
 'Natural': 'Manufactured',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that addresses environmental '
 'resourc ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that ad ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.366, -0.305, -0.240
guideline_match_Human_Financial: -0.053, 0.211, 0.474
guideline_match_Intellectual_Human: -0.413, -0.286, -0.159
guideline_match_Manufactured_Natural: 0.093, 0.153, 0.229
guideline_match_Natural_Social and relationship: 0.455, 0.818, 1.000
guideline_match_Social and relationship_Manufactured: 0.511, 0.667, 0.800
guideline_match: -0.114, -0.061, -0.009

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.081, 1.119, 1.163
tokens_per_sample: 1.081, 1.119, 1.163
fkgl_readability: 25.888, 26.617, 27.360

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.330, 0.393, 0.463
exact_match: 0.356, 0.396, 0.439
partial_match: 0.356, 0.396, 0.439
INFO:__main__:Processing label permutation 8 of 60:
{'Financial': 'Human',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Financial',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that pertains to monetary resources, assets, '
 'liabili ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that pertains to moneta ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Natural." => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Natural-based" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: 0.084, 0.156, 0.233
guideline_match_Human_Financial: 0.105, 0.289, 0.474
guideline_match_Intellectual_Intellectual: 0.365, 0.587, 0.746
guideline_match_Manufactured_Human: -0.305, -0.212, -0.127
guideline_match_Natural_Social and relationship: -0.273, 0.273, 0.636
guideline_match_Social and relationship_Manufactured: 0.533, 0.733, 0.867
guideline_match: 0.127, 0.186, 0.242

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.026, 1.048, 1.078
tokens_per_sample: 1.026, 1.048, 1.078
fkgl_readability: 24.660, 25.417, 26.216

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.289, 0.352, 0.419
exact_match: 0.357, 0.396, 0.439
partial_match: 0.357, 0.396, 0.439
INFO:__main__:Processing label permutation 9 of 60:
{'Financial': 'Natural',
 'Human': 'Intellectual',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Social and relationship',
 'Natural': 'Human',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that refers to physical assets, infrastructure, '
  ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that refers to phy ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Environmental" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.149, -0.084, -0.019
guideline_match_Human_Natural: -0.684, -0.526, -0.342
guideline_match_Intellectual_Human: -0.175, -0.032, 0.111
guideline_match_Manufactured_Intellectual: -0.153, -0.076, -0.008
guideline_match_Natural_Financial: -0.727, -0.273, 0.273
guideline_match_Social and relationship_Manufactured: 0.089, 0.178, 0.311
guideline_match: -0.136, -0.089, -0.045

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.304, 1.367, 1.437
tokens_per_sample: 1.304, 1.367, 1.437
fkgl_readability: 23.211, 24.048, 24.912

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.404, 0.470, 0.544
exact_match: 0.348, 0.389, 0.430
partial_match: 0.348, 0.389, 0.430
INFO:__main__:Processing label permutation 10 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Financial',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that refers to physical assets, infrastructure, and '
 ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Financial: A sentence that refers to physic ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "None of the provided categories directly apply to the given text, as it does not pertain to financial, human, manufactured, social and relationship, intellectual, or natural aspects of a company." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "There is no specific concept mentioned in the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.248, -0.191, -0.137
guideline_match_Human_Human: 0.474, 0.737, 0.895
guideline_match_Intellectual_Social and relationship: -0.333, -0.190, -0.048
guideline_match_Manufactured_Financial: -0.034, 0.034, 0.102
guideline_match_Natural_Natural: -0.818, -0.273, 0.455
guideline_match_Social and relationship_Manufactured: 0.422, 0.622, 0.756
guideline_match: -0.058, -0.009, 0.041

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.104, 1.189, 1.476
tokens_per_sample: 1.104, 1.189, 1.476
fkgl_readability: 24.783, 25.551, 26.345

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.352, 0.448, 0.708
exact_match: 0.356, 0.396, 0.437
partial_match: 0.357, 0.398, 0.439
INFO:__main__:Processing label permutation 11 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Natural',
 'Natural': 'Financial',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Intellectual: A sentence that deals with the company's relationships and "
  ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             "- Intellectual: A sentence that deals with th ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "There is not enough information in the text provided to accurately classify it into one of the listed categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: -0.256, -0.202, -0.156
guideline_match_Human_Human: 0.263, 0.579, 0.789
guideline_match_Intellectual_Social and relationship: -0.032, 0.063, 0.159
guideline_match_Manufactured_Financial: -0.271, -0.161, -0.042
guideline_match_Natural_Manufactured: 0.091, 0.636, 0.909
guideline_match_Social and relationship_Intellectual: 0.178, 0.333, 0.489
guideline_match: -0.093, -0.045, 0.004

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.196, 1.257, 1.389
tokens_per_sample: 1.196, 1.257, 1.389
fkgl_readability: 25.128, 26.082, 27.067

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.346, 0.420, 0.545
exact_match: 0.361, 0.402, 0.444
partial_match: 0.361, 0.402, 0.444
INFO:__main__:Processing label permutation 12 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Financial',
 'Intellectual': 'Natural',
 'Manufactured': 'Human',
 'Natural': 'Manufactured',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that relates to intangible assets, '
 'k ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that re ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.332, -0.275, -0.221
guideline_match_Human_Manufactured: 0.342, 0.605, 0.789
guideline_match_Intellectual_Social and relationship: 0.016, 0.190, 0.349
guideline_match_Manufactured_Natural: 0.068, 0.169, 0.271
guideline_match_Natural_Intellectual: 0.000, 0.545, 0.818
guideline_match_Social and relationship_Financial: -0.089, 0.089, 0.267
guideline_match: -0.063, -0.013, 0.039

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.215, 1.267, 1.330
tokens_per_sample: 1.215, 1.267, 1.330
fkgl_readability: 23.650, 24.379, 25.142

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.378, 0.444, 0.515
exact_match: 0.374, 0.415, 0.457
partial_match: 0.374, 0.415, 0.457
INFO:__main__:Processing label permutation 13 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Natural',
 'Natural': 'Human',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that addresses environmental resources, '
 'sustain ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Manufactured: A sentence that addresses env ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.252, 0.366, 0.473
guideline_match_Human_Natural: 0.132, 0.395, 0.605
guideline_match_Intellectual_Human: -0.016, 0.175, 0.349
guideline_match_Manufactured_Intellectual: -0.144, -0.076, -0.017
guideline_match_Natural_Manufactured: nan, 1.000, nan
guideline_match_Social and relationship_Social and relationship: 0.333, 0.600, 0.778
guideline_match: 0.210, 0.281, 0.348

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.207, 1.259, 1.319
tokens_per_sample: 1.207, 1.259, 1.319
fkgl_readability: 23.275, 24.057, 24.840

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.274, 0.333, 0.400
exact_match: 0.354, 0.394, 0.435
partial_match: 0.354, 0.394, 0.435
INFO:__main__:Processing label permutation 14 of 60:
{'Financial': 'Financial',
 'Human': 'Manufactured',
 'Intellectual': 'Human',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Financial: A sentence that pertains to mone ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.832, 0.901, 0.947
guideline_match_Human_Intellectual: -0.263, -0.105, 0.053
guideline_match_Intellectual_Social and relationship: -0.333, -0.190, -0.032
guideline_match_Manufactured_Human: -0.398, -0.305, -0.212
guideline_match_Natural_Natural: -0.091, 0.636, 1.000
guideline_match_Social and relationship_Manufactured: 0.444, 0.644, 0.778
guideline_match: 0.346, 0.410, 0.469

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.052, 1.081, 1.122
tokens_per_sample: 1.052, 1.081, 1.122
fkgl_readability: 23.329, 24.024, 24.783

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.307, 0.370, 0.441
exact_match: 0.335, 0.374, 0.415
partial_match: 0.335, 0.374, 0.415
INFO:__main__:Processing label permutation 15 of 60:
{'Financial': 'Manufactured',
 'Human': 'Intellectual',
 'Intellectual': 'Natural',
 'Manufactured': 'Human',
 'Natural': 'Financial',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that addresses env ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: -0.164, -0.115, -0.065
guideline_match_Human_Manufactured: 0.184, 0.421, 0.632
guideline_match_Intellectual_Human: -0.016, 0.159, 0.333
guideline_match_Manufactured_Financial: -0.153, -0.025, 0.102
guideline_match_Natural_Intellectual: 0.091, 0.818, 1.000
guideline_match_Social and relationship_Social and relationship: 0.600, 0.822, 0.956
guideline_match: 0.019, 0.073, 0.128

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.237, 1.296, 1.359
tokens_per_sample: 1.237, 1.296, 1.359
fkgl_readability: 22.287, 23.131, 23.976

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.307, 0.370, 0.441
exact_match: 0.313, 0.352, 0.394
partial_match: 0.313, 0.352, 0.394
INFO:__main__:Processing label permutation 16 of 60:
{'Financial': 'Natural',
 'Human': 'Manufactured',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Human',
 'Natural': 'Intellectual',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that refers to physical assets, infrastructure, and '
 'ta ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that refers to physical a ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Human and Manufactured" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Legal and regulatory" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "This text does not fit into any of the concept categories provided." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "The given text "Shelley L. Reynolds" does not fit into any of the listed concept categories. It appears to be a person's name and does not provide information related to physical assets, financial data, human resources, intellectual property, social relationships, or environmental resources." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "The text does not fit into any of the concept categories provided." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.279, -0.218, -0.160
guideline_match_Human_Manufactured: -0.026, 0.237, 0.474
guideline_match_Intellectual_Natural: -0.206, -0.111, -0.048
guideline_match_Manufactured_Human: -0.297, -0.195, -0.093
guideline_match_Natural_Financial: -0.364, 0.091, 0.545
guideline_match_Social and relationship_Intellectual: 0.156, 0.378, 0.556
guideline_match: -0.160, -0.112, -0.063

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.010
tokens_per_sentence: 1.141, 1.221, 1.405
tokens_per_sample: 1.148, 1.270, 1.678
fkgl_readability: 26.548, 27.481, 28.438

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.010
tokens_diff: 0.374, 0.500, 0.896
exact_match: 0.359, 0.400, 0.441
partial_match: 0.363, 0.404, 0.444
INFO:__main__:Processing label permutation 17 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Natural',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Human',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that refers to physical assets, '
 'infr ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that re ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Environmental" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: -0.038, 0.011, 0.061
guideline_match_Human_Natural: -0.289, -0.105, 0.079
guideline_match_Intellectual_Intellectual: 0.587, 0.778, 0.905
guideline_match_Manufactured_Social and relationship: -0.314, -0.220, -0.127
guideline_match_Natural_Human: -0.182, 0.273, 0.636
guideline_match_Social and relationship_Financial: 0.111, 0.311, 0.489
guideline_match: 0.022, 0.073, 0.122

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.096, 1.133, 1.181
tokens_per_sample: 1.096, 1.133, 1.181
fkgl_readability: 23.591, 24.398, 25.244

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.307, 0.370, 0.441
exact_match: 0.363, 0.404, 0.446
partial_match: 0.363, 0.404, 0.446
INFO:__main__:Processing label permutation 18 of 60:
{'Financial': 'Human',
 'Human': 'Social and relationship',
 'Intellectual': 'Natural',
 'Manufactured': 'Financial',
 'Natural': 'Intellectual',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ...  "the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that addresses env ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Intellectual, Human." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.023, 0.080, 0.137
guideline_match_Human_Financial: -0.079, 0.000, 0.079
guideline_match_Intellectual_Natural: -0.143, 0.000, 0.143
guideline_match_Manufactured_Social and relationship: -0.110, -0.051, 0.000
guideline_match_Natural_Intellectual: -0.091, 0.636, 1.000
guideline_match_Social and relationship_Human: 0.089, 0.289, 0.467
guideline_match: 0.022, 0.065, 0.108

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.111, 1.154, 1.204
tokens_per_sample: 1.111, 1.154, 1.204
fkgl_readability: 23.694, 24.551, 25.432

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.280, 0.339, 0.407
exact_match: 0.389, 0.431, 0.474
partial_match: 0.391, 0.433, 0.476
INFO:__main__:Processing label permutation 19 of 60:
{'Financial': 'Manufactured',
 'Human': 'Financial',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Human',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Manufactured: A sentence that involves information about the company's "
 'w ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Manufactured: A sentence that involves info ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Corporate Governance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.344, -0.282, -0.225
guideline_match_Human_Manufactured: 0.500, 0.737, 0.895
guideline_match_Intellectual_Intellectual: 0.556, 0.746, 0.873
guideline_match_Manufactured_Financial: -0.169, -0.102, -0.042
guideline_match_Natural_Social and relationship: 0.364, 0.727, 0.909
guideline_match_Social and relationship_Natural: -0.444, -0.200, 0.067
guideline_match: -0.078, -0.022, 0.035

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.044, 1.074, 1.111
tokens_per_sample: 1.044, 1.074, 1.111
fkgl_readability: 26.671, 27.432, 28.189

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.293, 0.356, 0.422
exact_match: 0.343, 0.383, 0.424
partial_match: 0.343, 0.383, 0.424
INFO:__main__:Processing label permutation 20 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Manufactured',
 'Intellectual': 'Financial',
 'Manufactured': 'Intellectual',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "The text "Shelley L. Reynolds" does not provide enough information to be classified into any of the categories listed above. It appears to be a person's name and does not relate to any specific concept category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.015, 0.046, 0.107
guideline_match_Human_Social and relationship: 0.684, 0.895, 1.000
guideline_match_Intellectual_Manufactured: 0.365, 0.540, 0.683
guideline_match_Manufactured_Human: -0.331, -0.246, -0.167
guideline_match_Natural_Natural: 0.091, 0.818, 1.000
guideline_match_Social and relationship_Financial: 0.289, 0.422, 0.578
guideline_match: 0.095, 0.147, 0.199

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.010
tokens_per_sentence: 1.259, 1.325, 1.454
tokens_per_sample: 1.267, 1.363, 1.659
fkgl_readability: 24.045, 24.819, 25.632

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.010
tokens_diff: 0.485, 0.585, 0.874
exact_match: 0.261, 0.300, 0.339
partial_match: 0.261, 0.300, 0.339
INFO:__main__:Processing label permutation 21 of 60:
{'Financial': 'Intellectual',
 'Human': 'Manufactured',
 'Intellectual': 'Natural',
 'Manufactured': 'Social and relationship',
 'Natural': 'Human',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that addresses env ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Prediction "None of the categories listed above directly align with the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Manfactured" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "There is not enough information provided in the text to classify it into any of the categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.336, -0.275, -0.210
guideline_match_Human_Natural: -0.447, -0.289, -0.158
guideline_match_Intellectual_Financial: -0.048, 0.143, 0.333
guideline_match_Manufactured_Human: -0.212, -0.136, -0.076
guideline_match_Natural_Intellectual: 0.091, 0.636, 0.909
guideline_match_Social and relationship_Manufactured: 0.178, 0.356, 0.511
guideline_match: -0.173, -0.125, -0.076

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.163, 1.231, 1.370
tokens_per_sample: 1.163, 1.231, 1.370
fkgl_readability: 24.316, 25.077, 25.870

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.359, 0.439, 0.576
exact_match: 0.365, 0.406, 0.448
partial_match: 0.365, 0.406, 0.448
INFO:__main__:Processing label permutation 22 of 60:
{'Financial': 'Natural',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Human',
 'Natural': 'Manufactured',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and '
 ' ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that refers to physical ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Natural." => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Natural." => "Natural"
WARNING:llms.classifiers.models:Prediction "None of the categories listed above accurately classify the text "Shelley L. Reynolds." The text appears to be a name, which does not fit into any of the provided concept categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "- Financial" => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.183, -0.115, -0.042
guideline_match_Human_Manufactured: 0.421, 0.711, 0.895
guideline_match_Intellectual_Intellectual: 0.524, 0.714, 0.873
guideline_match_Manufactured_Natural: 0.161, 0.280, 0.390
guideline_match_Natural_Financial: -0.182, 0.364, 0.727
guideline_match_Social and relationship_Human: -0.111, 0.044, 0.200
guideline_match: 0.091, 0.151, 0.210

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.004, 1.019
tokens_per_sentence: 1.248, 1.310, 1.391
tokens_per_sample: 1.263, 1.356, 1.620
fkgl_readability: 24.004, 24.820, 25.672

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.004, 0.019
tokens_diff: 0.337, 0.430, 0.693
exact_match: 0.400, 0.443, 0.485
partial_match: 0.400, 0.443, 0.485
INFO:__main__:Processing label permutation 23 of 60:
{'Financial': 'Human',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that addresses environmental '
 'resourc ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that ad ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "This text does not fit into any of the categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "The given text "Shelley L. Reynolds" does not provide enough information to be classified into one of the listed categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.160, 0.240, 0.321
guideline_match_Human_Financial: -0.342, -0.184, -0.053
guideline_match_Intellectual_Intellectual: 0.714, 0.873, 0.968
guideline_match_Manufactured_Human: -0.297, -0.212, -0.136
guideline_match_Natural_Social and relationship: 0.545, 0.818, 1.000
guideline_match_Social and relationship_Natural: -0.067, 0.044, 0.156
guideline_match: 0.123, 0.181, 0.236

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.226, 1.300, 1.456
tokens_per_sample: 1.226, 1.300, 1.456
fkgl_readability: 25.695, 26.578, 27.463

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.370, 0.456, 0.611
exact_match: 0.380, 0.420, 0.463
partial_match: 0.380, 0.420, 0.463
INFO:__main__:Processing label permutation 24 of 60:
{'Financial': 'Intellectual',
 'Human': 'Manufactured',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Human',
 'Natural': 'Natural',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Manufactured: A sentence that involves information about the company's "
 'w ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Manufactured: A sentence that involves info ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Natural." => "Natural"
WARNING:llms.classifiers.models:Prediction "Unclassified" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "The given text "Shelley L. Reynolds" does not provide enough information to be classified into any of the concept categories listed above. It seems to be a person's name rather than a sentence related to the company's various aspects." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.332, -0.271, -0.214
guideline_match_Human_Manufactured: 0.500, 0.763, 0.921
guideline_match_Intellectual_Financial: -0.032, 0.095, 0.238
guideline_match_Manufactured_Human: -0.280, -0.195, -0.119
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Intellectual: 0.067, 0.289, 0.489
guideline_match: -0.117, -0.065, -0.013

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.010
tokens_per_sentence: 1.104, 1.158, 1.315
tokens_per_sample: 1.107, 1.200, 1.544
fkgl_readability: 26.834, 27.600, 28.417

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.010
tokens_diff: 0.319, 0.422, 0.750
exact_match: 0.348, 0.389, 0.430
partial_match: 0.348, 0.389, 0.430
INFO:__main__:Processing label permutation 25 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Intellectual',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Financial: A sentence that pertains to mone ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Prediction "There is not enough information in the text to classify it into one of the given concept categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.817, 0.885, 0.931
guideline_match_Human_Human: 0.263, 0.579, 0.789
guideline_match_Intellectual_Manufactured: -0.063, 0.111, 0.286
guideline_match_Manufactured_Intellectual: -0.271, -0.186, -0.110
guideline_match_Natural_Social and relationship: 0.000, 0.455, 0.818
guideline_match_Social and relationship_Natural: -0.289, -0.156, -0.067
guideline_match: 0.380, 0.441, 0.499

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.204, 1.267, 1.389
tokens_per_sample: 1.204, 1.267, 1.389
fkgl_readability: 22.183, 22.890, 23.642

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.307, 0.378, 0.500
exact_match: 0.350, 0.391, 0.433
partial_match: 0.350, 0.391, 0.433
INFO:__main__:Processing label permutation 26 of 60:
{'Financial': 'Natural',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that refers to physical assets, infrastructure, and '
 ' ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that refers to physical ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Environmental" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.378, 0.469, 0.557
guideline_match_Human_Human: 0.211, 0.526, 0.737
guideline_match_Intellectual_Intellectual: 0.492, 0.714, 0.841
guideline_match_Manufactured_Natural: 0.127, 0.220, 0.322
guideline_match_Natural_Financial: -0.545, -0.091, 0.364
guideline_match_Social and relationship_Social and relationship: 0.778, 0.956, 1.000
guideline_match: 0.415, 0.477, 0.536

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.207, 1.263, 1.322
tokens_per_sample: 1.207, 1.263, 1.322
fkgl_readability: 26.310, 27.168, 28.008

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.278, 0.337, 0.404
exact_match: 0.389, 0.430, 0.472
partial_match: 0.389, 0.430, 0.472
INFO:__main__:Processing label permutation 27 of 60:
{'Financial': 'Financial',
 'Human': 'Natural',
 'Intellectual': 'Human',
 'Manufactured': 'Intellectual',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that relates to intangible assets, knowledge, '
 'i ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Manufactured: A sentence that relates to in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "The text "Shelley L. Reynolds" does not provide enough information to be classified into one of the concept categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.374, 0.481, 0.580
guideline_match_Human_Intellectual: 0.184, 0.500, 0.737
guideline_match_Intellectual_Manufactured: 0.794, 0.921, 0.984
guideline_match_Manufactured_Natural: 0.042, 0.102, 0.178
guideline_match_Natural_Human: -0.545, -0.091, 0.455
guideline_match_Social and relationship_Social and relationship: 0.378, 0.644, 0.822
guideline_match: 0.385, 0.453, 0.516

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.193, 1.257, 1.415
tokens_per_sample: 1.193, 1.257, 1.415
fkgl_readability: 24.798, 25.533, 26.235

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.304, 0.376, 0.530
exact_match: 0.311, 0.350, 0.391
partial_match: 0.311, 0.350, 0.391
INFO:__main__:Processing label permutation 28 of 60:
{'Financial': 'Human',
 'Human': 'Intellectual',
 'Intellectual': 'Financial',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Human: A sentence that relates to intangible assets, knowledge, '
 'intellec ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that relates to intangibl ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Not applicable. The given text does not fall into any of the listed concept categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.115, -0.053, 0.011
guideline_match_Human_Financial: -0.184, -0.053, 0.079
guideline_match_Intellectual_Human: 0.000, 0.111, 0.238
guideline_match_Manufactured_Manufactured: 0.775, 0.881, 0.949
guideline_match_Natural_Natural: -0.273, 0.455, 0.818
guideline_match_Social and relationship_Social and relationship: 0.467, 0.733, 0.911
guideline_match: 0.190, 0.247, 0.301

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.009
tokens_per_sentence: 1.173, 1.225, 1.291
tokens_per_sample: 1.181, 1.241, 1.348
fkgl_readability: 23.928, 24.785, 25.707

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.009
tokens_diff: 0.293, 0.359, 0.470
exact_match: 0.419, 0.459, 0.500
partial_match: 0.419, 0.459, 0.500
INFO:__main__:Processing label permutation 29 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Social and relationship',
 'Manufactured': 'Intellectual',
 'Natural': 'Natural',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainability ' ... '
 "company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that addresses environm ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.534, 0.634, 0.718
guideline_match_Human_Human: 0.053, 0.368, 0.632
guideline_match_Intellectual_Manufactured: 0.556, 0.730, 0.841
guideline_match_Manufactured_Social and relationship: -0.220, -0.136, -0.059
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Intellectual: 0.067, 0.267, 0.444
guideline_match: 0.369, 0.434, 0.497

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.093, 1.130, 1.178
tokens_per_sample: 1.093, 1.130, 1.178
fkgl_readability: 24.327, 25.068, 25.848

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.326, 0.389, 0.456
exact_match: 0.341, 0.381, 0.422
partial_match: 0.341, 0.381, 0.422
INFO:__main__:Processing label permutation 30 of 60:
{'Financial': 'Human',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Natural',
 'Social and relationship': 'Manufactured'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that relates to intangible assets, knowledge, '
 'i ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that relates to in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Physical and relationship" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "None of the concept categories listed above can be applied to the text "Shelley L. Reynolds" as it does not pertain to any particular aspect or category." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.004, 0.073, 0.141
guideline_match_Human_Financial: 0.289, 0.500, 0.684
guideline_match_Intellectual_Intellectual: 0.587, 0.778, 0.905
guideline_match_Manufactured_Social and relationship: -0.042, 0.025, 0.093
guideline_match_Natural_Natural: -0.273, 0.455, 0.818
guideline_match_Social and relationship_Human: 0.333, 0.511, 0.667
guideline_match: 0.168, 0.220, 0.270

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.122, 1.191, 1.409
tokens_per_sample: 1.122, 1.191, 1.409
fkgl_readability: 24.538, 25.396, 26.283

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.319, 0.398, 0.604
exact_match: 0.389, 0.431, 0.472
partial_match: 0.389, 0.431, 0.472
INFO:__main__:Processing label permutation 31 of 60:
{'Financial': 'Intellectual',
 'Human': 'Human',
 'Intellectual': 'Natural',
 'Manufactured': 'Financial',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that pertains to monetary resources, assets, '
 'li ... mental responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Manufactured: A sentence that pertains to m ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Unclassified" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "None of the categories listed above directly apply to the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "- Intellectual" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.691, 0.763, 0.821
guideline_match_Human_Human: 0.263, 0.579, 0.789
guideline_match_Intellectual_Financial: -0.159, 0.048, 0.254
guideline_match_Manufactured_Natural: -0.017, 0.059, 0.136
guideline_match_Natural_Intellectual: -0.455, 0.182, 0.636
guideline_match_Social and relationship_Social and relationship: 0.733, 0.911, 1.000
guideline_match: 0.450, 0.511, 0.565

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.237, 1.296, 1.385
tokens_per_sample: 1.237, 1.296, 1.385
fkgl_readability: 25.964, 26.754, 27.509

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.304, 0.370, 0.463
exact_match: 0.293, 0.331, 0.372
partial_match: 0.293, 0.331, 0.372
INFO:__main__:Processing label permutation 32 of 60:
{'Financial': 'Intellectual',
 'Human': 'Human',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Natural',
 'Natural': 'Financial',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that pertains to monetary resources, assets, '
 'liabili ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that pertains to moneta ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: 0.015, 0.084, 0.153
guideline_match_Human_Human: 0.211, 0.526, 0.737
guideline_match_Intellectual_Financial: -0.079, 0.063, 0.206
guideline_match_Manufactured_Intellectual: -0.237, -0.119, 0.000
guideline_match_Natural_Manufactured: 0.545, 0.909, 1.000
guideline_match_Social and relationship_Social and relationship: 0.467, 0.733, 0.867
guideline_match: 0.086, 0.140, 0.196

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.219, 1.274, 1.333
tokens_per_sample: 1.219, 1.274, 1.333
fkgl_readability: 22.740, 23.543, 24.393

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.293, 0.356, 0.422
exact_match: 0.439, 0.481, 0.524
partial_match: 0.439, 0.481, 0.524
INFO:__main__:Processing label permutation 33 of 60:
{'Financial': 'Social and relationship',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "- Social and relationship" => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.095, 0.149, 0.206
guideline_match_Human_Social and relationship: 0.737, 0.947, 1.000
guideline_match_Intellectual_Intellectual: 0.365, 0.587, 0.778
guideline_match_Manufactured_Human: -0.263, -0.178, -0.102
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Financial: 0.200, 0.356, 0.511
guideline_match: 0.168, 0.220, 0.270

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.207, 1.259, 1.322
tokens_per_sample: 1.207, 1.259, 1.322
fkgl_readability: 23.966, 24.691, 25.441

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.448, 0.519, 0.593
exact_match: 0.359, 0.400, 0.443
partial_match: 0.359, 0.400, 0.443
INFO:__main__:Processing label permutation 34 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Human',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that refers to physical assets, infrastructure, '
  ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that refers to phy ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "The concept category for the text is not provided in the given information." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "None of the given concept categories fully encompass the provided text. However, if we were to associate it with the closest category, it could potentially be classified under "Intellectual."" => "Intellectual"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.519, 0.618, 0.710
guideline_match_Human_Manufactured: -0.079, 0.105, 0.289
guideline_match_Intellectual_Human: -0.095, -0.016, 0.063
guideline_match_Manufactured_Intellectual: -0.085, -0.017, 0.051
guideline_match_Natural_Natural: -0.273, 0.455, 0.818
guideline_match_Social and relationship_Social and relationship: 0.600, 0.822, 0.956
guideline_match: 0.318, 0.381, 0.439

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.167, 1.220, 1.313
tokens_per_sample: 1.167, 1.220, 1.313
fkgl_readability: 24.725, 25.609, 26.519

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.289, 0.354, 0.446
exact_match: 0.402, 0.443, 0.485
partial_match: 0.402, 0.443, 0.485
INFO:__main__:Processing label permutation 35 of 60:
{'Financial': 'Intellectual',
 'Human': 'Human',
 'Intellectual': 'Financial',
 'Manufactured': 'Natural',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that involves information ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Financial and Intellectual" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "None of the provided categories above directly apply to this text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "The category for the given text is Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Intellectual: -0.198, -0.126, -0.050
guideline_match_Human_Human: 0.632, 0.895, 1.000
guideline_match_Intellectual_Financial: -0.079, 0.016, 0.127
guideline_match_Manufactured_Natural: -0.161, -0.068, 0.025
guideline_match_Natural_Manufactured: 0.091, 0.818, 1.000
guideline_match_Social and relationship_Social and relationship: 0.644, 0.867, 0.956
guideline_match: 0.024, 0.078, 0.134

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.289, 1.354, 1.435
tokens_per_sample: 1.289, 1.354, 1.435
fkgl_readability: 23.628, 24.580, 25.540

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.322, 0.391, 0.476
exact_match: 0.406, 0.450, 0.491
partial_match: 0.406, 0.450, 0.491
INFO:__main__:Processing label permutation 36 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Financial'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that relates to intangible assets, knowledge, '
 'i ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that relates to in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "None of the given categories can be directly applied to the text "Shelley L. Reynolds" as it does not provide any information that can be classified into any of the given categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Social and relationship: -0.248, -0.187, -0.130
guideline_match_Human_Human: 0.211, 0.526, 0.737
guideline_match_Intellectual_Intellectual: 0.333, 0.556, 0.746
guideline_match_Manufactured_Financial: 0.017, 0.110, 0.203
guideline_match_Natural_Natural: -0.273, 0.273, 0.818
guideline_match_Social and relationship_Manufactured: 0.422, 0.622, 0.778
guideline_match: 0.035, 0.093, 0.149

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.081, 1.156, 1.415
tokens_per_sample: 1.081, 1.156, 1.415
fkgl_readability: 25.371, 26.190, 27.034

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.307, 0.393, 0.633
exact_match: 0.354, 0.394, 0.437
partial_match: 0.354, 0.394, 0.437
INFO:__main__:Processing label permutation 37 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Natural',
 'Manufactured': 'Manufactured',
 'Natural': 'Human',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Intellectual: A sentence that addresses environmental resources, '
 'sustain ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Intellectual: A sentence that addresses env ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Natural." => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "Intellectual, Manufactured, Financial, Natural, Social and relationship" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.565, 0.664, 0.748
guideline_match_Human_Natural: -0.132, 0.079, 0.289
guideline_match_Intellectual_Human: 0.127, 0.317, 0.492
guideline_match_Manufactured_Manufactured: 0.593, 0.729, 0.847
guideline_match_Natural_Intellectual: 0.091, 0.636, 1.000
guideline_match_Social and relationship_Social and relationship: 0.600, 0.822, 0.956
guideline_match: 0.544, 0.609, 0.669

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.215, 1.274, 1.352
tokens_per_sample: 1.215, 1.274, 1.352
fkgl_readability: 21.825, 22.613, 23.442

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.311, 0.378, 0.459
exact_match: 0.341, 0.381, 0.426
partial_match: 0.343, 0.383, 0.426
INFO:__main__:Processing label permutation 38 of 60:
{'Financial': 'Financial',
 'Human': 'Social and relationship',
 'Intellectual': 'Human',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Intellectual'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainability ' ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that addresses environm ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "- Natural" => "Natural"
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Prediction "Human and Social and relationship" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal and Regulatory." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "None of the listed categories specifically apply to the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.557, 0.656, 0.740
guideline_match_Human_Intellectual: 0.211, 0.395, 0.553
guideline_match_Intellectual_Social and relationship: -0.302, -0.190, -0.111
guideline_match_Manufactured_Manufactured: 0.508, 0.661, 0.780
guideline_match_Natural_Natural: nan, 1.000, nan
guideline_match_Social and relationship_Human: 0.267, 0.533, 0.733
guideline_match: 0.471, 0.536, 0.598

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.048, 1.085, 1.167
tokens_per_sample: 1.048, 1.085, 1.167
fkgl_readability: 23.673, 24.549, 25.428

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.285, 0.352, 0.435
exact_match: 0.387, 0.428, 0.470
partial_match: 0.389, 0.430, 0.472
INFO:__main__:Processing label permutation 39 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Social and relationship',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... financial performance.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that involves information ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "- Financial" => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.160, 0.282, 0.397
guideline_match_Human_Human: 0.684, 0.895, 1.000
guideline_match_Intellectual_Intellectual: 0.587, 0.778, 0.905
guideline_match_Manufactured_Manufactured: 0.559, 0.712, 0.831
guideline_match_Natural_Social and relationship: -0.091, 0.273, 0.636
guideline_match_Social and relationship_Natural: -0.311, -0.178, -0.067
guideline_match: 0.365, 0.439, 0.510

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.211, 1.263, 1.322
tokens_per_sample: 1.211, 1.263, 1.322
fkgl_readability: 23.658, 24.546, 25.497

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.270, 0.330, 0.396
exact_match: 0.454, 0.496, 0.537
partial_match: 0.454, 0.496, 0.537
INFO:__main__:Processing label permutation 40 of 60:
{'Financial': 'Financial',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Human',
 'Social and relationship': 'Natural'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that deals with the company's relationships and "
 'intera ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             "- Human: A sentence that deals with the compa ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "- Human" => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "- Natural" => "Natural"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.656, 0.748, 0.824
guideline_match_Human_Natural: -0.132, -0.026, 0.053
guideline_match_Intellectual_Intellectual: 0.333, 0.556, 0.746
guideline_match_Manufactured_Manufactured: 0.356, 0.525, 0.661
guideline_match_Natural_Social and relationship: 0.359, 0.636, 0.909
guideline_match_Social and relationship_Human: 0.667, 0.867, 0.956
guideline_match: 0.564, 0.629, 0.687

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.019, 1.037, 1.067
tokens_per_sample: 1.019, 1.037, 1.067
fkgl_readability: 21.247, 22.093, 22.975

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.289, 0.348, 0.415
exact_match: 0.376, 0.417, 0.459
partial_match: 0.376, 0.417, 0.459
INFO:__main__:Processing label permutation 41 of 60:
{'Financial': 'Natural',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Financial',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 'relati ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that de ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "None of the above categories" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "This text does not belong to any of the concept categories provided. It appears to be the name or description of a specific product or brand, rather than a sentence that fits into one of the defined categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured" => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "None of the concept categories listed above directly apply to the given text. The text does not provide any specific information related to social and relationship, natural, intellectual, human, financial, or manufactured aspects of a company. Thus, it cannot be classified into any of the categories provided." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and Relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Natural: -0.225, -0.156, -0.088
guideline_match_Human_Human: 0.211, 0.526, 0.737
guideline_match_Intellectual_Intellectual: 0.556, 0.746, 0.873
guideline_match_Manufactured_Manufactured: 0.288, 0.458, 0.610
guideline_match_Natural_Financial: -0.364, 0.182, 0.636
guideline_match_Social and relationship_Social and relationship: 0.778, 0.956, 1.000
guideline_match: 0.165, 0.232, 0.297

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.006, 1.020
tokens_per_sentence: 1.393, 1.484, 1.640
tokens_per_sample: 1.422, 1.593, 2.015
fkgl_readability: 22.435, 23.281, 24.173

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.006, 0.020
tokens_diff: 0.426, 0.600, 1.025
exact_match: 0.443, 0.485, 0.528
partial_match: 0.444, 0.487, 0.530
INFO:__main__:Processing label permutation 42 of 60:
{'Financial': 'Financial',
 'Human': 'Manufactured',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Social and relationship',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Social and relationship: A sentence that involves information about the '
 " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that in ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "None of the categories listed above are applicable to the text "Shelley L. Reynolds" because it does not contain any information that falls within the defined concept categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.313, 0.420, 0.527
guideline_match_Human_Social and relationship: 0.526, 0.789, 0.947
guideline_match_Intellectual_Intellectual: 0.429, 0.651, 0.810
guideline_match_Manufactured_Human: -0.119, -0.059, -0.025
guideline_match_Natural_Natural: -0.365, 0.273, 0.818
guideline_match_Social and relationship_Manufactured: 0.578, 0.711, 0.822
guideline_match: 0.322, 0.389, 0.456

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.181, 1.256, 1.470
tokens_per_sample: 1.181, 1.256, 1.470
fkgl_readability: 26.079, 26.815, 27.563

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.463, 0.552, 0.752
exact_match: 0.324, 0.363, 0.406
partial_match: 0.324, 0.363, 0.406
INFO:__main__:Processing label permutation 43 of 60:
{'Financial': 'Financial',
 'Human': 'Social and relationship',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Human'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... the company's success.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Financial: A sentence that pertains to mone ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "Financial, Manufactured, Natural" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Human and Social and relationship" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual assets" => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Human and Social and relationship" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "No category for the given text as it does not provide any information to classify it into one of the concept categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.802, 0.870, 0.924
guideline_match_Human_Social and relationship: -0.132, 0.026, 0.211
guideline_match_Intellectual_Intellectual: 0.492, 0.683, 0.841
guideline_match_Manufactured_Manufactured: 0.271, 0.441, 0.593
guideline_match_Natural_Natural: 0.091, 0.818, 1.000
guideline_match_Social and relationship_Human: -0.067, 0.089, 0.244
guideline_match: 0.564, 0.628, 0.685

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.170, 1.237, 1.400
tokens_per_sample: 1.170, 1.237, 1.400
fkgl_readability: 22.726, 23.516, 24.340

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.344, 0.422, 0.581
exact_match: 0.380, 0.420, 0.463
partial_match: 0.381, 0.422, 0.465
INFO:__main__:Processing label permutation 44 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Natural',
 'Manufactured': 'Manufactured',
 'Natural': 'Intellectual',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 'relati ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that de ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "Governance" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.634, 0.725, 0.802
guideline_match_Human_Human: 0.368, 0.684, 0.895
guideline_match_Intellectual_Natural: -0.365, -0.238, -0.111
guideline_match_Manufactured_Manufactured: 0.780, 0.881, 0.949
guideline_match_Natural_Intellectual: -0.455, 0.182, 0.636
guideline_match_Social and relationship_Social and relationship: 0.644, 0.867, 0.956
guideline_match: 0.580, 0.643, 0.701

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.196, 1.248, 1.307
tokens_per_sample: 1.196, 1.248, 1.307
fkgl_readability: 23.157, 23.946, 24.783

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.304, 0.367, 0.437
exact_match: 0.396, 0.437, 0.480
partial_match: 0.396, 0.437, 0.480
INFO:__main__:Processing label permutation 45 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... al "
 'responsibility.\n'
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that involves information ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "None of the categories listed above perfectly match the content of the given text. However, if we had to choose one, it could fit under the Financial category." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.classifiers.models:Prediction "Legal" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "None of the categories mentioned above directly align with the text provided. This text is more focused on the values within the company and does not specifically address human resources, manufactured assets, social and relationship assets, financial resources, intellectual assets, or natural resources." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "The text falls into the "Financial" category." => "Financial"
WARNING:llms.classifiers.models:Prediction "Technologies" is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.550, 0.649, 0.733
guideline_match_Human_Human: 0.632, 0.895, 1.000
guideline_match_Intellectual_Intellectual: 0.460, 0.683, 0.841
guideline_match_Manufactured_Manufactured: 0.594, 0.746, 0.847
guideline_match_Natural_Natural: -0.273, 0.455, 0.818
guideline_match_Social and relationship_Social and relationship: 0.333, 0.600, 0.778
guideline_match: 0.616, 0.683, 0.743

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.204, 1.274, 1.452
tokens_per_sample: 1.211, 1.320, 1.713
fkgl_readability: 23.162, 24.006, 24.874

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.304, 0.417, 0.821
exact_match: 0.420, 0.461, 0.504
partial_match: 0.422, 0.463, 0.506
INFO:__main__:Processing label permutation 46 of 60:
{'Financial': 'Financial',
 'Human': 'Intellectual',
 'Intellectual': 'Human',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Manufactured: A sentence that refers to physical assets, infrastructure, '
  ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Manufactured: A sentence that refers to phy ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "None of the categories listed above apply to the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "None of the categories listed above accurately classify the given text. The text does not pertain to any specific assets, resources, or relationships mentioned in the categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "There is no clear category for the given text." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.466, 0.573, 0.664
guideline_match_Human_Intellectual: -0.026, 0.105, 0.263
guideline_match_Intellectual_Human: -0.206, -0.048, 0.111
guideline_match_Manufactured_Manufactured: 0.729, 0.847, 0.932
guideline_match_Natural_Natural: -0.091, 0.636, 1.000
guideline_match_Social and relationship_Social and relationship: 0.244, 0.511, 0.733
guideline_match: 0.454, 0.522, 0.586

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.011
tokens_per_sentence: 1.170, 1.238, 1.356
tokens_per_sample: 1.181, 1.267, 1.492
fkgl_readability: 23.292, 24.084, 24.910

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.011
tokens_diff: 0.307, 0.400, 0.617
exact_match: 0.404, 0.444, 0.487
partial_match: 0.404, 0.444, 0.487
INFO:__main__:Processing label permutation 47 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Natural',
 'Natural': 'Manufactured',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Financial: A sentence that pertains to monetary resources, assets, '
 'liabi ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Financial: A sentence that pertains to mone ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Legal and Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "The text "Shelley L. Reynolds" does not fit into any of the concept categories provided. It appears to be a person's name and does not pertain to financial, social and relationship, natural, manufactured, human, or intellectual aspects." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.832, 0.901, 0.947
guideline_match_Human_Human: 0.316, 0.632, 0.842
guideline_match_Intellectual_Intellectual: 0.143, 0.397, 0.619
guideline_match_Manufactured_Natural: 0.000, 0.127, 0.254
guideline_match_Natural_Manufactured: 0.364, 0.727, 0.909
guideline_match_Social and relationship_Social and relationship: 0.378, 0.644, 0.822
guideline_match: 0.566, 0.628, 0.683

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: 1.000, 1.002, 1.010
tokens_per_sentence: 1.159, 1.223, 1.381
tokens_per_sample: 1.167, 1.267, 1.626
fkgl_readability: 21.913, 22.624, 23.389

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: 0.000, 0.002, 0.010
tokens_diff: 0.315, 0.422, 0.766
exact_match: 0.389, 0.430, 0.472
partial_match: 0.391, 0.431, 0.472
INFO:__main__:Processing label permutation 48 of 60:
{'Financial': 'Manufactured',
 'Human': 'Human',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Financial',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Human: A sentence that involves information about the company's workforce, " ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Human: A sentence that involves information ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Manufactured'
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Human." => "Human"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Manufactured: 0.004, 0.084, 0.168
guideline_match_Human_Human: 0.737, 0.947, 1.000
guideline_match_Intellectual_Intellectual: 0.651, 0.841, 0.937
guideline_match_Manufactured_Financial: -0.254, -0.178, -0.119
guideline_match_Natural_Natural: -0.091, 0.636, 1.000
guideline_match_Social and relationship_Social and relationship: 0.289, 0.556, 0.778
guideline_match: 0.166, 0.227, 0.285

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.148, 1.193, 1.248
tokens_per_sample: 1.148, 1.193, 1.248
fkgl_readability: 24.921, 25.815, 26.711

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.256, 0.311, 0.378
exact_match: 0.457, 0.500, 0.543
partial_match: 0.457, 0.500, 0.543
INFO:__main__:Processing label permutation 49 of 60:
{'Financial': 'Financial',
 'Human': 'Natural',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Human',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Natural: A sentence that involves information about the company's "
 'workfo ... ations and reputation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that involves informati ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Intellectual." => "Intellectual"
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Prediction "None of the provided categories apply to the text "Shelley L. Reynolds" as it does not pertain to any specific aspect related to a company's workforce, financials, natural resources, intellectual assets, manufactured resources, or social relationships." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.695, 0.779, 0.847
guideline_match_Human_Natural: 0.395, 0.684, 0.868
guideline_match_Intellectual_Intellectual: 0.524, 0.746, 0.873
guideline_match_Manufactured_Manufactured: 0.675, 0.797, 0.881
guideline_match_Natural_Human: -0.273, 0.364, 0.818
guideline_match_Social and relationship_Social and relationship: 0.111, 0.422, 0.644
guideline_match: 0.670, 0.734, 0.788

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.126, 1.222, 1.563
tokens_per_sample: 1.126, 1.222, 1.563
fkgl_readability: 24.282, 25.058, 25.824

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.300, 0.400, 0.729
exact_match: 0.335, 0.376, 0.417
partial_match: 0.335, 0.376, 0.417
INFO:__main__:Processing label permutation 50 of 60:
{'Financial': 'Financial',
 'Human': 'Human',
 'Intellectual': 'Manufactured',
 'Manufactured': 'Intellectual',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 "- Social and relationship: A sentence that deals with the company's "
 'relati ... o the company's value.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Social and relationship: A sentence that de ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "The given text "Shelley L. Reynolds" does not provide enough information for classification into any of the concept categories listed above." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Prediction "Governance." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 2 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Financial: 0.603, 0.695, 0.779
guideline_match_Human_Human: 0.211, 0.526, 0.737
guideline_match_Intellectual_Manufactured: 0.413, 0.603, 0.746
guideline_match_Manufactured_Intellectual: -0.229, -0.153, -0.093
guideline_match_Natural_Natural: 0.091, 0.818, 1.000
guideline_match_Social and relationship_Social and relationship: 0.600, 0.822, 0.956
guideline_match: 0.433, 0.498, 0.558

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.204, 1.270, 1.437
tokens_per_sample: 1.204, 1.270, 1.437
fkgl_readability: 22.341, 23.002, 23.703

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.337, 0.411, 0.561
exact_match: 0.369, 0.409, 0.452
partial_match: 0.369, 0.409, 0.452
INFO:__main__:Processing label permutation 51 of 60:
{'Financial': 'Human',
 'Human': 'Financial',
 'Intellectual': 'Intellectual',
 'Manufactured': 'Manufactured',
 'Natural': 'Natural',
 'Social and relationship': 'Social and relationship'}
INFO:__main__:Parameters:
{'add_previous_text': False,
 'add_task_prompt': True,
 'balanced': True,
 'concept': 'capital',
 'domain': 'financial',
 'empty_definition': False,
 'examples_per_label': 1,
 'guidelines': ('definition',),
 'label_noise': 'random',
 'n_permutations': 60,
 'seed': 17,
 'source_key': 'text'}
INFO:llms.evaluation:Loaded 1500 samples from /mnt/work/datasets/finance/financial_concepts/annotation-reviewed/data/annotation/reports_sample_eacl.csv
INFO:llms.evaluation:Sampling balanced data for 6 classes (maximum of 90 samples per class; seed=17)
INFO:llms.evaluation:Added 90 samples for class "Financial"
INFO:llms.evaluation:Added 90 samples for class "Human"
INFO:llms.evaluation:Added 90 samples for class "Intellectual"
INFO:llms.evaluation:Added 90 samples for class "Manufactured"
INFO:llms.evaluation:Added 90 samples for class "Natural"
INFO:llms.evaluation:Added 90 samples for class "Social and relationship"
INFO:llms.evaluation:Shuffling data using seed: 17
INFO:llms.evaluation:Evaluating gpt-3.5-turbo-0613 on 540 samples.
INFO:llms.inference:Using model: <class 'llms.classifiers.models.OpenAIClassifier'>
INFO:llms.inference:Token statistics for input:
{'mean_tokens': 310.35185185185185,
 'mean_truncation': -3511.6833333333334,
 'total_tokens': 167590,
 'total_truncation': -1896309}
INFO:llms.models.base:System prompt: None
INFO:llms.models.base:Context prompt: ('Consider the following concept categories:\n'
 '\n'
 '- Natural: A sentence that addresses environmental resources, sustainability ' ... veness and innovation.\n"
 '\n'
 'Classify the text below into one of the categories listed above.\n'
 'Be concise and write only the category name.')
INFO:llms.models.base:Input prompt: ('Text: Azerbaijan In April 2020, Chevron sold its 9.6 percent nonoperated '
 'interest in Azerbaijan International Operating Company and its 8.9 percent '
 'interest in the Baku-Tbilisi-Ceyhan (BTC) pipeline affiliate.')
INFO:llms.models.base:User prompt: 'Concept:'
INFO:llms.models.base:Truncating input to 3839 max tokens
INFO:llms.models.base:Model kwargs:
{}
INFO:llms.models.base:Generation kwargs:
{'max_tokens': 256, 'memoizer_ignore_cache': False}
INFO:llms.models.base:Model input:
[{'content': 'Consider the following concept categories:\n'
             '\n'
             '- Natural: A sentence that addresses environm ... 9 percent interest in the Baku-Tbilisi-Ceyhan '
             '(BTC) pipeline affiliate.',
  'role': 'user'},
 {'content': 'Concept:', 'role': 'user'}]
INFO:llms.models.base:Output:
'Financial'
WARNING:llms.classifiers.models:Fixing prediction: "Financial." => "Financial"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Fixing prediction: "Manufactured." => "Manufactured"
WARNING:llms.classifiers.models:Prediction "Unfortunately, without any context or additional information, it is not possible to classify the text into one of the listed categories." is not in labels: {'Financial': 'Financial', 'Human': 'Human', 'Intellectual': 'Intellectual', 'Manufactured': 'Manufactured', 'Natural': 'Natural', 'Social and relationship': 'Social and relationship'}.
WARNING:llms.classifiers.models:Fixing prediction: "Social and relationship." => "Social and relationship"
WARNING:llms.metrics:Ignoring 278 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 502 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 477 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 422 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 529 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 495 null score values in confidence interval computation
WARNING:llms.metrics:Ignoring 3 null score values in confidence interval computation
INFO:llms.metrics:guideline_match_Financial_Human: -0.359, -0.302, -0.248
guideline_match_Human_Financial: -0.237, 0.026, 0.263
guideline_match_Intellectual_Intellectual: 0.270, 0.492, 0.683
guideline_match_Manufactured_Manufactured: 0.763, 0.881, 0.949
guideline_match_Natural_Natural: 0.091, 0.818, 1.000
guideline_match_Social and relationship_Social and relationship: 0.333, 0.600, 0.778
guideline_match: 0.108, 0.173, 0.240

> classification_metrics:

> source_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 29.846, 31.215, 32.782
tokens_per_sample: 29.846, 31.215, 32.782
fkgl_readability: 14.885, 15.433, 15.993

> prediction_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.174, 1.239, 1.394
tokens_per_sample: 1.174, 1.239, 1.394
fkgl_readability: 24.697, 25.444, 26.222

> reference_stats:
sentences_per_sample: nan, 1.000, nan
tokens_per_sentence: 1.274, 1.333, 1.400
tokens_per_sample: 1.274, 1.333, 1.400
fkgl_readability: 21.904, 22.883, 23.874

> length_diff:
sentences_diff: nan, 0.000, nan
tokens_diff: 0.322, 0.394, 0.548
exact_match: 0.426, 0.467, 0.509
partial_match: 0.426, 0.467, 0.509
INFO:__main__:No permutations remaining. Exiting loop.
INFO:__main__:Correlation with permutation_edit_distance:
permutation_edit_distance      1.000000
permutation_rouge1_distance    0.996017
permutation_rouge2_distance    0.997411
accuracy                      -0.434815
Name: permutation_edit_distance, dtype: float64
INFO:__main__:Correlation with permutation_rouge1_distance:
permutation_edit_distance      0.996017
permutation_rouge1_distance    1.000000
permutation_rouge2_distance    0.998380
accuracy                      -0.435730
Name: permutation_rouge1_distance, dtype: float64
INFO:__main__:Correlation with permutation_rouge2_distance:
permutation_edit_distance      0.997411
permutation_rouge1_distance    0.998380
permutation_rouge2_distance    1.000000
accuracy                      -0.443139
Name: permutation_rouge2_distance, dtype: float64
INFO:__main__:Permutation metric counts:
{0.0: 1,
 0.33333333333333337: 10,
 0.5: 10,
 0.6666666666666667: 10,
 0.8333333333333334: 10,
 1.0: 10}
